import{u as ge,l as fe,j as e,c as As,i as ye}from"./utils.7znXe2qs.js";import{r as i}from"./index.sXsv9c-e.js";import{h as Ie,i as qe,l as ts,$ as is,a as ns,b as cs,c as ds,u as Bs}from"./Init.SOFaEcmE.js";import{C as J,a as W,b as X,c as K,d as ae,e as Ps,$ as os}from"./users.2JVUOKN_.js";import{C as Fs,D as Ss,e as Cs,a as Ts,b as Ms,c as Ls,d as _s,R as Ye}from"./dialog.8c9vlkZb.js";import{B as be}from"./button.y_h6KplI.js";import{B as E}from"./badge.RD5J5VmT.js";import{S as w}from"./skeleton.ImyGLEBt.js";import{e as ms,t as He,d as Ve,h as ke,j as Ds,i as ws,T as Se,a as Ce,b as S,c as le}from"./common.YW9z4-R6.js";import{H as Re,a as ze,b as Qe}from"./hover-card.F9x-xBCG.js";import{u as $s,F as us,a as ne,b as ce,c as oe,f as de,d as ve,e as je}from"./form.pcaInan5.js";import{S as Ze,a as es,b as ss,c as Hs,d as we}from"./select.g7-eRQiF.js";import{f as Es,C as Vs}from"./calendar.zlnU7BEF.js";import{P as Pe,a as Fe,b as $e}from"./popover.gjoHTB1X.js";import{I as Q}from"./input.HaIIg_lG.js";import{L as Oe,D as Us}from"./DeepLinkDialog.pfbpEg12.js";import{S as Je,C as hs,a as xs}from"./separator.4MKw57oH.js";import{F as Is}from"./index.esm.NBzIaSv3.js";import{A as ps}from"./AssetDropDownCard.V_Mxw5mt.js";import{M as js}from"./MarketAssetCard.NhkO2-7-.js";import{S as We}from"./scroll-area.tGn2UR9l.js";import{E as Ue}from"./ExternalLink.9rrHieRs.js";import{P as qs}from"./PoolDialogs.dZ6sHwlG.js";import{b as Rs,d as zs}from"./Market.7msWVBV3.js";import{f as bs,c as gs,a as fs}from"./Assets.0kJX-SNW.js";import"./index.TXmbRjpk.js";import"./index.QjywInIh.js";import"./index.8KvaaAxm.js";import"./index.Qq4mV9Nn.js";import"./index.2IglCrjI.js";import"./index.f2GGseSc.js";import"./index.w9rix0mX.js";import"./fuse.aCsZfKX4.js";import"./CardRow.xn8Wqc99.js";function ys(s){const{usr:l,thisAssetA:r,thisAssetB:a,assetAData:t,assetBData:d,orderType:n,marketSearch:c,usrBalances:o,fee:m,invertedMarket:x}=s,{t:h,i18n:u}=ge(fe.get(),{i18n:ye}),{buyOrders:p,sellOrders:j}=s,[b,y]=i.useState(0),[g,N]=i.useState(0),[v,f]=i.useState(0),k=i.useMemo((()=>{let e=0;if(b&&g&&v){if("buy"===n&&t&&t.market_fee_percent&&t.market_fee_percent>0)return e=parseFloat(b)*(t.market_fee_percent/100),e.toFixed(t.precision);if("sell"===n&&d&&d.market_fee_percent&&d.market_fee_percent>0)return e=parseFloat(v)*(d.market_fee_percent/100),e.toFixed(d.precision)}return e}),[b,g,v,n,t,d]),[O,S]=i.useState("1hr"),[C,w]=i.useState((()=>{const e=new Date;return new Date(e.getTime()+36e5)})),[M,T]=i.useState(new Date(Date.now()+6048e5));i.useEffect((()=>{"specific"===O&&M&&w(M)}),[O,M]);const L=$s({defaultValues:{account:""}}),[D,_]=i.useState(!1);function A(e,s){const l=e.id,r=s.find((e=>e.asset_id===l));return r?ke(r.amount,e.precision).toLocaleString(void 0,{minimumFractionDigits:e.precision}):0}const B=i.useMemo((()=>t&&o?A(t,o):0),[t,o]),F=i.useMemo((()=>d&&o?A(d,o):0),[d,o]),[P,$]=i.useState(!1),[H,V]=i.useState(1),[I,q]=i.useState(100),[R,z]=i.useState(1e6),[U,G]=i.useState(!1);i.useEffect((()=>{c&&c.length&&window.location.search&&async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()),l=s.amount,r=s.price,a=s.oso,i=s.spreadPercent,n=s.sizePercent,c=s.expirationSeconds,o=s.repeat;let m=b,x=g,h=v,u=P,p=H,j=I,y=R,N=U;const f=ke(1,t.precision),k=ke(1,d.precision);if(l){const e=parseFloat(l);e&&(m=e>=f?e:f)}if(r){const e=parseFloat(r);e&&(x=e>=k?e:k)}if(m&&x){const e=parseFloat((m*x).toFixed(d.precision));h=e>=k?e:k}if(a){const e="true"===a;e&&(u=e)}if(i){const e=parseFloat(i);e&&e>=0&&e<=100?p=parseFloat(e.toFixed(3)):e&&e>100?p=100:e&&e<0&&(p=0)}if(n){const e=parseFloat(n);e&&e>=0&&e<=100?j=parseFloat(e.toFixed(3)):e&&e>100?j=100:e&&e<0&&(j=0)}if(c){const e=parseFloat(c);e&&(y=e)}if(o){const e="true"===o;e&&(N=e)}return{finalAmount:m,finalPrice:x,finalTotal:h,finalOSO:u,finalSpreadPercent:p,finalSizePercent:j,finalExpirationSeconds:y,finalRepeat:N}}().then((({finalAmount:e,finalPrice:s,finalTotal:l,finalOSO:i,finalSpreadPercent:t,finalSizePercent:d,finalExpirationSeconds:c,finalRepeat:o})=>{e!==b&&y(e),s!==g&&N(s),l!==v&&f(l),i!==P&&$(i),t!==H&&V(t),d!==I&&q(d),c!==R&&z(c),o!==U&&G(o);let m=`?market=${r}_${a}&type=${n}&price=${s}&amount=${e}`;i&&(m+=`&oso=${i}&spreadPercent=${t}&sizePercent=${d}&expirationSeconds=${c}&repeat=${o}`),window.history.replaceState({},"",m)}))}),[]);const[Z,Y]=i.useState(0);i.useEffect((()=>{if(Z>0){let e=`?market=${r}_${a}&type=${n}&price=${g}&amount=${b}`;P&&(e+=`&oso=${P}&spreadPercent=${H}&sizePercent=${I}&expirationSeconds=${R}&repeat=${U}`),window.history.replaceState({},"",e)}}),[b,g,v,P,H,I,R,U]);const ee=i.useCallback(ms(((e,s)=>{/^[0-9]*\.?[0-9]*$/.test(e)&&e>=0&&e<=100&&(V(e),Y(Z+1))}),25),[]),se=i.useCallback(ms(((e,s)=>{/^[0-9]*\.?[0-9]*$/.test(e)&&e>=0&&e<=100&&(q(e),Y(Z+1))}),25),[]);return e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(X,{children:h("buy"===n?"LimitOrderCard:buyingWith":"LimitOrderCard:sellingFor",{assetA:r,assetB:a})}),e.jsx(K,{children:h("LimitOrderCard:createLimitOrder")})]}),e.jsxs(ae,{children:[r&&a&&c&&t&&d?e.jsx(us,{...L,children:e.jsxs("form",{onSubmit:e=>{_(!0),e.preventDefault()},children:[e.jsx(ne,{control:L.control,name:"priceAmount",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{children:h("LimitOrderCard:priceAmount.label")}),e.jsx(de,{children:h("LimitOrderCard:priceAmount.description",{assetA:r,assetB:a})}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(Q,{label:"Price",placeholder:g,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:priceAmount.provideNewLabel")})," ",e.jsx(Q,{placeholder:g,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(N(e.toFixed("buy"===n?d.precision:t.precision)),b&&f((e*b).toFixed("buy"===n?d.precision:t.precision)),Y(Z+1))}}}),"buy"===n&&!j||j&&!j.length||"sell"===n&&!p||p&&!p.length?e.jsx(E,{disabled:!0,children:h("buy"===n?"LimitOrderCard:priceAmount.useLowestAsk":"LimitOrderCard:priceAmount.useHighestBid")}):e.jsx("span",{variant:"link",onClick:e=>{let s;e.preventDefault(),"buy"===n&&j&&j.length>0?s=He(parseFloat(j[0].price),d.precision):"sell"===n&&p&&p.length>0&&(s=He(parseFloat(p[0].price),d.precision)),s&&(N(parseFloat(s).toFixed(d.precision)),b&&f((parseFloat(s)*parseFloat(b)).toFixed(d.precision)),Y(Z+1))},children:e.jsx(E,{children:h("buy"===n?"LimitOrderCard:priceAmount.useLowestAsk":"LimitOrderCard:priceAmount.useHighestBid")})})]})]})})]})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"sellAmount",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{children:h("LimitOrderCard:sellAmount.label")}),e.jsx(de,{children:h("buy"===n?"LimitOrderCard:sellAmount.buyDescription":"LimitOrderCard:sellAmount.sellDescription",{asset:r})}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(Q,{label:"Amount",placeholder:b,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:sellAmount.provideNewLabel")})," ",e.jsx(Q,{placeholder:b,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(y(e.toFixed(t.precision)),g&&f((e*g).toFixed(d.precision)),Y(Z+1))}}}),"sell"===n&&B?e.jsx(E,{onClick:()=>{let e=parseFloat(B.replaceAll(",",""));e&&(y(e.toFixed(t.precision)),g&&f((e*g).toFixed(d.precision)),Y(Z+1))},children:h("LimitOrderCard:useBalance")}):null]})]})})]})})]})}),e.jsx(ne,{control:L.control,name:"sellTotal",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{children:h("LimitOrderCard:sellTotal.label")}),e.jsx(de,{children:h("buy"===n?"LimitOrderCard:sellTotal.buyDescription":"LimitOrderCard:sellTotal.sellDescription",{asset:a})}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(Q,{label:"Total",placeholder:v,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:sellTotal.provideNewLabel")}),e.jsx(Q,{placeholder:v,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(f(e.toFixed(d.precision)),g&&y((e/g).toFixed(t.precision)),Y(Z+1))}}}),"buy"===n&&F?e.jsx(E,{onClick:()=>{let e=parseFloat(F.replaceAll(",",""));e&&(f(e.toFixed(d.precision)),g&&y((e/g).toFixed(t.precision)),Y(Z+1))},children:h("LimitOrderCard:useBalance")}):null]})]})})]})}),b&&g&&F&&parseFloat(F.replaceAll(",",""))<parseFloat(v)?e.jsx(je,{children:h("LimitOrderCard:sellTotal.requireMore",{requiredAmount:v-parseFloat(F.replaceAll(",","")).toFixed(d.precision),asset:a})}):null]})}),e.jsx(ne,{control:L.control,name:"expiry",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:expiry.label")}),e.jsx(ve,{onValueChange:e=>{S(e);const s=36e5,l=24*s;if("specific"!==e&&"fkill"!==e){const r=new Date;let a;if("1hr"===e)a=new Date(r.getTime()+s);else if("12hr"===e){const e=12*s;a=new Date(r.getTime()+e)}else if("24hr"===e){const e=l;a=new Date(r.getTime()+e)}else if("7d"===e){const e=7*l;a=new Date(r.getTime()+e)}else if("30d"===e){const e=30*l;a=new Date(r.getTime()+e)}a&&T(a),w(e)}else if("fkill"===e){const e=new Date;w(new Date(e.getTime()+l))}else"specific"===e&&w();Y(Z+1)},children:e.jsxs(Ze,{children:[e.jsx(es,{className:"mb-3",children:e.jsx(ss,{placeholder:"1hr"})}),e.jsxs(Hs,{className:"bg-white",children:[e.jsx(we,{value:"1hr",children:h("LimitOrderCard:expiry.1hr")}),e.jsx(we,{value:"12hr",children:h("LimitOrderCard:expiry.12hr")}),e.jsx(we,{value:"24hr",children:h("LimitOrderCard:expiry.24hr")}),e.jsx(we,{value:"7d",children:h("LimitOrderCard:expiry.7d")}),e.jsx(we,{value:"30d",children:h("LimitOrderCard:expiry.30d")}),e.jsx(we,{value:"specific",children:h("LimitOrderCard:expiry.specific")}),e.jsx(we,{value:"fkill",children:h("LimitOrderCard:expiry.fkill")})]})]})}),e.jsxs(de,{children:["specific"===O?e.jsxs(Pe,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(be,{variant:"outline",className:As("w-[240px] justify-start text-left font-normal",!M&&"text-muted-foreground"),children:[e.jsx(Fs,{className:"mr-2 h-4 w-4"}),M?Es(M,"PPP"):e.jsx("span",{children:h("LimitOrderCard:expiry.pickDate")})]})}),e.jsx($e,{className:"w-auto p-0",align:"start",children:e.jsx(Vs,{mode:"single",selected:M,onSelect:e=>{new Date(e)<new Date?T(new Date(Date.now()+864e5)):T(e)},initialFocus:!0})})]}):null,"fkill"===O?h("LimitOrderCard:expiry.fkillDescription"):null,"specific"!==O&&"fkill"!==O?h("LimitOrderCard:expiry.generalDescription",{expiryType:O}):null]}),e.jsx(je,{})]})}),e.jsx(Je,{className:"mb-2 mt-2"}),e.jsx(ne,{control:L.control,name:"osoValue",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(ve,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{id:"terms1",checked:P,onClick:()=>{$(!P),Y(Z+1)}}),e.jsx("label",{htmlFor:"terms1",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:h(P?"LimitOrderCard:osoValue.enabled":"LimitOrderCard:osoValue.enable")})]})}),P?e.jsx(de,{children:h("LimitOrderCard:osoValue.description")}):null]})}),P?e.jsxs(e.Fragment,{children:[e.jsx(ne,{control:L.control,name:"osoSpread",render:({field:s})=>e.jsxs(ce,{className:"mt-2 text-xs",children:[e.jsx(oe,{className:"text-sm",children:h("LimitOrderCard:osoEnabled.spreadPercentLabel")}),e.jsx(de,{children:h("LimitOrderCard:osoEnabled.spreadPercentDescription")}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsxs("span",{className:"col-span-9",children:[e.jsx(Q,{label:h("LimitOrderCard:osoEnabled.spreadPercentLabel"),placeholder:H,disabled:!0,readOnly:!0}),e.jsx(xs,{className:"mt-3",defaultValue:[H],max:100,min:1,step:.01,onValueChange:e=>{ee(e[0])}})]}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{onClick:()=>{event.preventDefault()},className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:osoEnabled.provideNewSpreadPercent")}),e.jsx(Q,{placeholder:H,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;s&&s.length&&/^[0-9]*\.?[0-9]*$/.test(s)&&s>=1&&s<=100&&(V(s),Y(Z+1))}})]})]})})]})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"osoSize",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{className:"text-sm",children:h("LimitOrderCard:osoSize.sizePercentLabel")}),e.jsx(de,{children:h("LimitOrderCard:osoSize.sizePercentDescription")}),e.jsx(ve,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsxs("span",{className:"col-span-9",children:[e.jsx(Q,{label:h("LimitOrderCard:osoSize.sizePercentLabel"),placeholder:I,disabled:!0,readOnly:!0}),e.jsx(xs,{className:"mt-3",defaultValue:[I],max:100,min:0,step:.01,onValueChange:e=>{se(e[0])}})]}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(Pe,{children:[e.jsx(Fe,{children:e.jsx("span",{onClick:()=>{event.preventDefault()},className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(Oe,{children:h("LimitOrderCard:editLabel")})})}),e.jsxs($e,{children:[e.jsx(Oe,{children:h("LimitOrderCard:osoSize.provideNewSizePercent")}),e.jsx(Q,{placeholder:I,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;s&&s.length&&/^[0-9]*\.?[0-9]*$/.test(s)&&s>=0&&s<=100&&(q(s),Y(Z+1))}})]})]})})]})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"repeatValue",render:({field:s})=>e.jsxs(ce,{className:"mt-4 text-xs",children:[e.jsx(oe,{className:"text-sm",children:h("LimitOrderCard:repeatValue.label")}),e.jsx(de,{children:h("LimitOrderCard:repeatValue.description")}),e.jsx(ve,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{id:"terms2",checked:U,onClick:()=>{G(!U),Y(Z+1)}}),e.jsx("label",{htmlFor:"terms2",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:h(U?"LimitOrderCard:repeatValue.enabled":"LimitOrderCard:repeatValue.disabled")})]})}),e.jsx(je,{})]})})]}):null,e.jsx(Je,{className:"mt-3"}),e.jsx(ne,{control:L.control,disabled:!0,name:"fee",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:fee.label")}),e.jsx(de,{children:h("LimitOrderCard:fee.description")}),e.jsx(ve,{children:e.jsx(Q,{disabled:!0,label:h("LimitOrderCard:fee.label"),value:`${m} BTS`,placeholder:1})}),"fkill"===O||l.id===l.referrer?e.jsxs(je,{children:["fkill"===O?h("LimitOrderCard:fee.unfilledRebate",{fee:m}):null,e.jsx("br",{}),l.id===l.referrer?h("LimitOrderCard:fee.ltmRebate",{rebate:.8*m}):null]}):null]})}),"buy"===n&&t&&t.market_fee_percent&&t.market_fee_percent>0?e.jsx(ne,{control:L.control,disabled:!0,name:"marketFees",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:marketFees.label")}),e.jsx(ve,{children:e.jsx(Q,{disabled:!0,value:`${k} ${t.symbol}`,placeholder:`${k} ${t.symbol}`})}),e.jsx(de,{children:h("LimitOrderCard:marketFees.description")})]})}):null,"sell"===n&&d&&d.market_fee_percent&&d.market_fee_percent>0?e.jsx(ne,{control:L.control,disabled:!0,name:"marketFees",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:marketFees.label")}),e.jsx(ve,{children:e.jsx(Q,{disabled:!0,value:`${k} ${d.symbol}`,placeholder:`${k} ${d.symbol}`})}),e.jsx(je,{}),e.jsx(de,{children:h("LimitOrderCard:marketFees.description")})]})}):null,b&&g&&C?e.jsx(be,{className:"mt-7 mb-1",variant:"outline",type:"submit",children:h("LimitOrderCard:submit")}):e.jsx(be,{className:"mt-7 mb-1",variant:"outline",disabled:!0,type:"submit",children:h("LimitOrderCard:submit")})]})}):e.jsx(us,{...L,children:e.jsxs("form",{children:[e.jsx(ne,{control:L.control,name:"sellPrice",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:h("LimitOrderCard:sellPrice.label")}),e.jsx("div",{className:"text-gray-500 text-right",children:e.jsx("span",{variant:"link",children:e.jsx(E,{children:h("LimitOrderCard:sellPrice.useLowestAsk")})})})]})}),e.jsx(Q,{disabled:!0,className:"mb-3"}),e.jsx(de,{children:h("LimitOrderCard:sellPrice.description")}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"sellAmount",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:h("LimitOrderCard:sellAmount2.label")}),e.jsx("div",{className:"text-gray-500 text-right",children:"sell"===n&&B?e.jsx(E,{children:h("LimitOrderCard:useBalance")}):null})]})}),e.jsx(de,{children:h("buy"===n?"LimitOrderCard:sellAmount2.buyDescription":"LimitOrderCard:sellAmount2.sellDescription")}),e.jsx(Q,{disabled:!0,className:"mb-3"}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,name:"sellTotal",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:h("LimitOrderCard:sellTotal2.label")}),e.jsx("div",{className:"text-gray-500 text-right",children:"buy"===n&&F?e.jsx(E,{children:h("LimitOrderCard:useBalance")}):null})]})}),e.jsx(de,{children:h("buy"===n?"LimitOrderCard:sellTotal2.buyDescription":"LimitOrderCard:sellTotal2.sellDescription")}),e.jsx(Q,{disabled:!0,className:"mb-3"})]})}),e.jsx(ne,{control:L.control,name:"expiry",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:expiry2.label")}),e.jsx(de,{children:h("LimitOrderCard:expiry2.description")}),e.jsx(Ze,{disabled:!0,children:e.jsx(es,{className:"mb-3",children:e.jsx(ss,{placeholder:"1hr"})})}),e.jsx(je,{})]})}),e.jsx(ne,{control:L.control,disabled:!0,name:"fee",render:({field:s})=>e.jsxs(ce,{children:[e.jsx(oe,{children:h("LimitOrderCard:fee.label")}),e.jsx(Q,{disabled:!0,label:h("LimitOrderCard:fee.label")}),e.jsx(de,{children:h("LimitOrderCard:fee.description")}),"fkill"===O||l.id===l.referrer?e.jsxs(je,{children:["fkill"===O?h("LimitOrderCard:fee.unfilledRebate",{rebate:.4826}):null,l.id===l.referrer?h("LimitOrderCard:fee.ltmRebate",{rebate:.38608}):null]}):null]})}),e.jsx(be,{disabled:!0,className:"mt-7 mb-1",variant:"outline",type:"submit",children:h("LimitOrderCard:submit")})]})}),D?e.jsx(Us,{operationName:"limit_order_create",username:l.username,usrChain:l.chain,userID:l.id,dismissCallback:_,headerText:h("buy"===n?"LimitOrderCard:headerText.buying":"LimitOrderCard:headerText.selling",{amount:b,thisAssetA:r,total:v,thisAssetB:a}),trxJSON:"buy"===n?[{seller:l.id,amount_to_sell:{amount:Ve(v,d.precision).toFixed(0),asset_id:c.find((e=>e.s===a)).id},min_to_receive:{amount:Ve(b,t.precision).toFixed(0),asset_id:c.find((e=>e.s===r)).id},expiration:C,fill_or_kill:"fkill"===O,extensions:P?{on_fill:[[0,{fee_asset_id:"1.3.0",spread_percent:H?100*H:0,size_percent:I?100*I:0,expiration_seconds:1e9,repeat:U}]]}:{}}]:[{seller:l.id,amount_to_sell:{amount:Ve(b,t.precision).toFixed(0),asset_id:c.find((e=>e.s===r)).id},min_to_receive:{amount:Ve(v,d.precision).toFixed(0),asset_id:c.find((e=>e.s===a)).id},expiration:C,fill_or_kill:"fkill"===O,extensions:P?{on_fill:[[0,{fee_asset_id:"1.3.0",spread_percent:H,size_percent:I,expiration_seconds:1e9,repeat:U}]]}:{}}]},"buy"===n?`Buying${b}${r}for${v}${a}`:`Selling${b}${r}for${v}${a}`):null]})]})}function Ns(s){const{cardType:l,activeLimitCard:r,assetA:a,assetAData:t,assetB:d,assetBData:n,buyOrders:c,previousBuyOrders:o,sellOrders:m,previousSellOrders:x,marketOrdersLoading:h,orderBookItr:u,setOrderBookItr:p,_resetOrders:j,invertedMarket:b}=s,{t:y,i18n:g}=ge(fe.get(),{i18n:ye});let N,v,f,k;return!h||c||m||o||o.length||x||x.length?(N=y("buy"===l?"MarketOrderCard:openBuyLimitOrdersTitle":"MarketOrderCard:openSellLimitOrdersTitle"),v=y("buy"===l?"MarketOrderCard:buyLimitOrdersDescription":"MarketOrderCard:sellLimitOrdersDescription",{assetA:a,assetB:d}),f=({index:s,style:r})=>{let h;"buy"===l&&c?h=c:"buy"===l&&o?h=o:"sell"===l&&m?h=m:"sell"===l&&x&&(h=x);const u=h[s],p=parseFloat(u.price).toFixed(n.precision),j=parseFloat(u.base),b=parseFloat(u.quote),g=h.slice(0,s+1).map((e=>parseFloat(e.base))).reduce(((e,s)=>e+s),0).toFixed(n.precision),N=h.slice(0,s+1).map((e=>parseFloat(e.quote))).reduce(((e,s)=>e+s),0).toFixed(t.precision),v=i.useMemo((()=>"buy"===l?`/dex/index.html?market=${a}_${d}&type=sell&price=${p}&amount=${N}`:`/dex/index.html?market=${a}_${d}&type=buy&price=${p}&amount=${N}`),[a,d,p,g,N]);return e.jsx("div",{style:r,children:e.jsxs(Ss,{children:[e.jsx(Cs,{asChild:!0,children:e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-l-2 border-r-2 pl-3",children:p}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?j:b}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?b:j}),e.jsx("div",{className:"col-span-1 pl-3",children:g}),e.jsx("div",{className:"col-span-4",children:e.jsx(Je,{})})]})},`moc_${l}_${s}`)}),e.jsxs(Ts,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(Ms,{children:[e.jsx(Ls,{children:y("MarketOrderCard:proceedLimitOrderDataTitle")}),e.jsx(_s,{children:y("MarketOrderCard:proceedLimitOrderDataDescription",{cardType:"buy"===l?"sell":"buy"})})]}),e.jsx("span",{className:"pt-3",children:"buy"===l?y("MarketOrderCard:sellingQuoteForBase",{totalQuote:N,assetA:a,totalBase:g,assetB:d}):y("MarketOrderCard:sellingBaseForQuote",{totalBase:g,assetB:d,totalQuote:N,assetA:a})}),e.jsx("span",{children:y("MarketOrderCard:pricePerAsset",{price:p,assetB:d,assetA:a})}),e.jsx("a",{href:v,children:e.jsx(be,{className:"mt-2 h-6",children:y("MarketOrderCard:proceedButton")})})]})]},`${l}Dialog${s}`)})},k="buy"===l?c?c.length:o.length:m?m.length:x.length):(N=y("MarketOrderCard:loadingMarketOrdersTitle"),v=y("MarketOrderCard:loadingMarketOrdersDescription"),f=({index:s,style:r})=>{const a="buy"===l?o:x,i=a&&a.length?a[s]:null,d=i?parseFloat(i.price).toFixed(t.precision):null,n=i?parseFloat(i.base):null,c=i?parseFloat(i.quote):null,m=a&&a.length?a.slice(0,s+1).map((e=>parseFloat(e.base))).reduce(((e,s)=>e+s),0).toFixed(t.precision):null;return e.jsx("div",{style:r,children:e.jsxs(Re,{children:[e.jsx(ze,{asChild:!0,children:e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 border-l-2 border-r-2 pl-3",children:d}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:n}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:c}),e.jsx("div",{className:"col-span-1 pl-3",children:m})]}):e.jsx("div",{className:"col-span-4",children:e.jsx(w,{className:"h-4 w-full"})}),e.jsx("div",{className:"col-span-4",children:e.jsx(Je,{})})]})},`moc_loading_${l}_${s}`)}),e.jsxs(Qe,{className:"w-80 text-sm pt-3",children:[y("MarketOrderCard:marketDataRefreshing"),e.jsx("br",{}),e.jsx(w,{className:"h-4 w-full"})]})]},`loadingOrderHoverCard${s}`)})},k=10),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:N}),e.jsx(K,{children:v})]}),e.jsxs(ae,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:"Price"}),e.jsxs("div",{className:"col-span-1 pl-3 text-md",children:["sell"===l&&a&&a.length<12?a:null,"sell"===l&&a&&a.length>=12&&t?t.id:null,"buy"===l&&d&&d.length<12?d:null,"buy"===l&&d&&d.length>=12&&n?n.id:null]}),e.jsxs("div",{className:"col-span-1 pl-3",children:["sell"===l&&d&&d.length<12?d:null,"sell"===l&&d&&d.length>=12&&n?n.id:null,"buy"===l&&a&&a.length<12?a:null,"buy"===l&&a&&a.length>=12&&t?t.id:null]}),e.jsxs("div",{className:"col-span-1 pl-3",children:[d&&d.length<7?`Total (${d})`:null,d&&d.length>=7&&n?`Total (${n.id})`:null]})]}),e.jsx(Is,{height:300,itemCount:k,itemSize:20,children:f})]})]})}function Qs(s){const{type:l,publicMarketHistory:r,assetAData:a,assetBData:t}=s;ge(fe.get(),{i18n:ye});const d=i.useMemo((()=>r.filter((e=>e.type===l))),[r,l]),n=i.useMemo((()=>d.map(((s,r)=>{const i=s.price.split("."),d=a&&t&&i.length>1?He(s.price,"buy"===l?a.precision:t.precision):s.price;return e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:d}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:s.amount}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:Ds(s.date)}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:s.value})]})},`ms_${r}_${l}`)}))),[d,a,t,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 pl-3 text-md",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Price"}),e.jsxs("div",{className:"col-span-1 text-sm",children:[a?a.symbol:"?","/",t?t.symbol:"?"]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Amount"}),e.jsx("div",{className:"col-span-1 text-sm",children:a?a.symbol:"?"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Date"}),e.jsx("div",{className:"col-span-1 text-sm",children:"Time since trade"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Total value"}),e.jsx("div",{className:"col-span-1 text-sm",children:t?t.symbol:"?"})]})})]}),e.jsx(We,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-4",children:n.length?n:null})})]})}function vs(s){const{type:l,publicMarketHistory:r,marketHistoryInProgress:a,reset:i,assetAData:t,assetBData:d}=s,{t:n,i18n:c}=ge(fe.get(),{i18n:ye});return e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:n("buy"===l?"MarketTradeContents:recentlyCompletedBuyOrdersTitle":"MarketTradeContents:recentlyCompletedSellOrdersTitle")}),e.jsx(K,{children:n("buy"===l?"MarketTradeContents:recentlyCompletedBuyOrdersDescription":"MarketTradeContents:recentlyCompletedSellOrdersDescription")})]}),e.jsxs(ae,{className:"space-y-2",children:[a?e.jsx(w,{count:5}):null,r&&r.length?e.jsx(Qs,{type:l,publicMarketHistory:r,assetAData:t,assetBData:d}):n("MarketTradeContents:noMarketHistoryFound")]})]})}function Js(s){const{type:l,assetAData:r,assetBData:a,usrLimitOrders:t}=s,{t:d,i18n:n}=ge(fe.get(),{i18n:ye}),c=i.useMemo((()=>t.filter((e=>"buy"===l?e.sell_price.base.asset_id===r.id:e.sell_price.base.asset_id===a.id)).map((e=>{const s=[r,a].find((s=>s.id===e.sell_price.base.asset_id)).precision,i=[r,a].find((s=>s.id===e.sell_price.quote.asset_id)).precision,t=ws(e.sell_price.base.asset_id,e.sell_price.quote.asset_id);let d=ke(e.sell_price.base.amount,s),n=ke(e.sell_price.quote.amount,i),c=parseFloat(t?d/n:d*n),o=0,m=0;const x=ke(e.for_sale,s);return"buy"!==l||t?"buy"===l&&t?(o=(c*x).toFixed(s),m=x.toFixed(i)):"sell"!==l||t?"sell"===l&&t&&(o=(x/c).toFixed(i),m=x.toFixed(s)):(o=x.toFixed(i),m=(c*x).toFixed(s)):(m=(c*x).toFixed(i),o=x.toFixed(s)),{...e,price:c,paying:m,receiving:o,basePrecision:s,quotePrecision:i}})).sort(((e,s)=>e.price-s.price))),[t,l,r,a]),o=i.useMemo((()=>c.map(((s,r)=>{const a=ke(1,s.basePrecision),i=ke(1,s.quotePrecision);return e.jsxs(Ss,{children:[e.jsx(Cs,{asChild:!0,children:e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"grid grid-cols-4 border-b-2 text-sm",children:[e.jsxs("div",{className:"col-span-1 border-r-2 pl-3",children:["buy"===l&&s.price<i?e.jsxs(Re,{children:[e.jsx(ze,{children:`< ${i}`}),e.jsx(Qe,{className:"w-"+5*s.quotePrecision,children:s.price})]},`hover_less_than_min_${s.id.replace("1.7.","")}`):null,"sell"===l&&s.price<a?e.jsxs(Re,{children:[e.jsx(ze,{children:`< ${a}`}),e.jsx(Qe,{className:"w-"+5*s.basePrecision,children:s.price})]},`hover_less_than_min_${s.id.replace("1.7.","")}`):null,"buy"===l&&s.price>=i?s.price.toFixed(s.quotePrecision):null,"sell"===l&&s.price>=a?s.price.toFixed(s.basePrecision):null]}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.receiving}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.paying}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.expiration.replace("T"," ")})]})},`mos_${r}_${l}`)}),e.jsxs(Ts,{className:"sm:max-w-[600px] bg-white",children:[e.jsxs(Ms,{children:[e.jsx(Ls,{children:d("MyOrderSummary:editLimitOrderTitle")}),e.jsx(_s,{children:d("MyOrderSummary:editLimitOrderDescription")})]}),e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsxs("div",{className:"col-span-1",children:[d("MyOrderSummary:selectedOpenOrderData"),e.jsx(We,{className:"h-72 rounded-md border text-sm",children:e.jsx("pre",{children:JSON.stringify(s,null,2)})})]}),e.jsxs("div",{className:"col-span-1 text-left mt-5",children:[e.jsx("a",{href:`/order/index.html?id=${s.id}`,children:e.jsx(be,{variant:"outline",className:"mt-2 mr-2",children:d("MyOrderSummary:proceedToUpdateButton")})}),e.jsx(Ue,{variant:"outline",classnamecontents:"",type:"button",text:d("MyOrderSummary:viewObjectOnBlocksights"),hyperlink:`https://blocksights.info/#/objects/${s.id}`})]})]})]})]},`${l}Dialog${r}`)}))),[c,r,a,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:d("MyOrderSummary:priceColumnTitle")}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:r.symbol}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:a.symbol}),e.jsx("div",{className:"col-span-1 pl-3",children:d("MyOrderSummary:expirationDateColumnTitle")})]}),e.jsx(We,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-3",children:o})})]})}function ks(s){const{type:l,assetAData:r,assetBData:a,usrLimitOrders:t,usrHistory:d,marketHistoryInProgress:n,reset:c}=s,{t:o,i18n:m}=ge(fe.get(),{i18n:ye}),x=i.useMemo((()=>t&&t.length?"buy"===l?t.filter((e=>e.sell_price.quote.asset_id===a.id)):t.filter((e=>e.sell_price.quote.asset_id===r.id)):t?[]:null),[t,l,r,a]);return e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:o("buy"===l?"MyOpenOrders:openBuyOrdersTitle":"MyOpenOrders:openSellOrdersTitle")}),e.jsx(K,{children:o("buy"===l?"MyOpenOrders:openBuyOrdersDescription":"MyOpenOrders:openSellOrdersDescription",{assetA:r.symbol,assetB:a.symbol})})]}),e.jsx(ae,{className:"space-y-2",children:x&&!n?e.jsx(Js,{type:l,assetAData:r,assetBData:a,usrLimitOrders:x}):null})]})}function Ws(s){const{type:l,usrHistory:r,assetAData:a,assetBData:t}=s,{t:d,i18n:n}=ge(fe.get(),{i18n:ye}),c=i.useMemo((()=>r?r.filter((e=>"buy"===l?e.op[1].pays.asset_id===t.id&&e.op[1].receives.asset_id===a.id:e.op[1].pays.asset_id===a.id&&e.op[1].receives.asset_id===t.id)).map((e=>{const s=ke(e.op[1].fill_price.base.amount,[a,t].find((s=>s.id===e.op[1].fill_price.base.asset_id))?.precision),l=ke(e.op[1].fill_price.quote.amount,[a,t].find((s=>s.id===e.op[1].receives.asset_id))?.precision);return{price:(l/s).toFixed(t.precision),baseAmount:s,quoteAmount:l,date:e.block_time,operation:e.op[1]}})):[]),[r,a,t,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:d("MyTradeSummary:priceColumnTitle")}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:"buy"===l?a.symbol:t.symbol}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:"buy"===l?t.symbol:a.symbol}),e.jsx("div",{className:"col-span-1 pl-3",children:d("MyTradeSummary:dateColumnTitle")})]}),e.jsx(We,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-4",children:c.map(((s,r)=>e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.price}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?s.baseAmount:s.quoteAmount}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?s.quoteAmount:s.baseAmount}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:Ds(s.date)})]})},`mts_${r}_${l}`)))})})]})}function Os(s){const{type:l,usrHistory:r,marketHistoryInProgress:a,reset:i,assetAData:t,assetBData:d}=s,{t:n,i18n:c}=ge(fe.get(),{i18n:ye});return e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:n("buy"===l?"MyCompletedTrades:recentlyCompletedBuyOrdersTitle":"MyCompletedTrades:recentlyCompletedSellOrdersTitle")}),e.jsx(K,{children:n("buy"===l?"MyCompletedTrades:recentlyCompletedBuyOrdersDescription":"MyCompletedTrades:recentlyCompletedSellOrdersDescription")})]}),e.jsxs(ae,{className:"space-y-2",children:[r&&r.length||a?null:"buy"===l?e.jsx(e.Fragment,{children:n("MyCompletedTrades:noRecentlyCompletedPurchases")}):e.jsx(e.Fragment,{children:n("MyCompletedTrades:noRecentlyCompletedSales")}),r&&r.length?e.jsx(Ws,{type:l,usrHistory:r,assetAData:t,assetBData:d}):null]})]})}function Xs(s){const{activeLimitCard:l,assetAData:r,assetBData:a,usr:t,marketItr:d,setMarketItr:n,usrLimitOrders:c,usrHistory:o,publicMarketHistory:m,_resetMarketData:x}=s,{t:h,i18n:u}=ge(fe.get(),{i18n:ye}),[p,j]=i.useState(!1);i.useEffect((()=>{m&&j(!1)}),[m]);const[b,y]=i.useState("marketTrades"),[g,N]=i.useState("buy"),[v,f]=i.useState("buy"),[k,O]=i.useState("buy"),C={backgroundColor:"#252526",color:"white"};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 mt-5",children:e.jsxs(Se,{defaultValue:"marketTrades",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-3 gap-2",children:["marketTrades"===b?e.jsx(S,{value:"marketTrades",style:C,children:h("MarketSummaryTabs:marketTradesTabTitle")}):e.jsx(S,{value:"marketTrades",onClick:()=>y("marketTrades"),children:h("MarketSummaryTabs:marketTradesTabTitle")}),"usrLimitOrders"===b?e.jsx(S,{value:"usrLimitOrders",style:C,children:h("MarketSummaryTabs:yourOpenOrdersTabTitle")}):e.jsx(S,{value:"usrLimitOrders",onClick:()=>y("usrLimitOrders"),children:h("MarketSummaryTabs:yourOpenOrdersTabTitle")})]}),e.jsx(le,{value:"marketTrades",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===g?e.jsx(S,{value:"buy",style:C,children:h("MarketSummaryTabs:buyOrdersTabTitle")}):e.jsx(S,{value:"buy",onClick:()=>N("buy"),children:h("MarketSummaryTabs:buyOrdersTabTitle")}),"sell"===g?e.jsx(S,{value:"sell",style:C,children:h("MarketSummaryTabs:sellOrdersTabTitle")}):e.jsx(S,{value:"sell",onClick:()=>N("sell"),children:h("MarketSummaryTabs:sellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(vs,{type:"buy",publicMarketHistory:m,marketHistoryInProgress:p,reset:()=>{x(),j(!0),n(d+1)},assetAData:r,assetBData:a})}),e.jsx(le,{value:"sell",children:e.jsx(vs,{type:"sell",publicMarketHistory:m,marketHistoryInProgress:p,reset:()=>{x(),j(!0),n(d+1)},assetAData:r,assetBData:a})})]})}),e.jsx(le,{value:"usrHistory",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===v?e.jsx(S,{value:"buy",style:C,children:h("MarketSummaryTabs:buyOrdersTabTitle")}):e.jsx(S,{value:"buy",onClick:()=>f("buy"),children:h("MarketSummaryTabs:buyOrdersTabTitle")}),"sell"===v?e.jsx(S,{value:"sell",style:C,children:h("MarketSummaryTabs:sellOrdersTabTitle")}):e.jsx(S,{value:"sell",onClick:()=>f("sell"),children:h("MarketSummaryTabs:sellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(Os,{type:"buy",assetAData:r,assetBData:a,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),n(d+1)}})}),e.jsx(le,{value:"sell",children:e.jsx(Os,{type:"sell",assetAData:r,assetBData:a,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),n(d+1)}})})]})}),e.jsx(le,{value:"usrLimitOrders",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===k?e.jsx(S,{value:"buy",style:C,children:h("MarketSummaryTabs:yourBuyOrdersTabTitle")}):e.jsx(S,{value:"buy",onClick:()=>O("buy"),children:h("MarketSummaryTabs:yourBuyOrdersTabTitle")}),"sell"===k?e.jsx(S,{value:"sell",style:C,children:h("MarketSummaryTabs:yourSellOrdersTabTitle")}):e.jsx(S,{value:"sell",onClick:()=>O("sell"),children:h("MarketSummaryTabs:yourSellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(ks,{type:"buy",assetAData:r,assetBData:a,usrLimitOrders:c,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),n(d+1)}})}),e.jsx(le,{value:"sell",children:e.jsx(ks,{type:"sell",assetAData:r,assetBData:a,usrLimitOrders:c,usrHistory:o,marketHistoryInProgress:p,reset:()=>{x(),j(!0),n(d+1)}})})]})})]})})})}function Gs(s){const{usr:l,assetA:r,assetB:a,assetAData:t,assetADetails:d,assetABitassetData:n,assetBData:c,assetBDetails:o,assetBBitassetData:m,limitOrderFee:x,setAssetA:h,setAssetB:u}=s,{t:p,i18n:j}=ge(fe.get(),{i18n:ye}),b=i.useSyncExternalStore(Ie.subscribe,Ie.get,(()=>!0)),y=i.useSyncExternalStore(qe.subscribe,qe.get,(()=>!0)),g=i.useMemo((()=>l&&l.chain&&(b||y)?"bitshares"===l.chain?b:y:[]),[b,y,l]),[N,v]=i.useState(null),[f,k]=i.useState(null),[O,C]=i.useState([]),[M,T]=i.useState([]),[L,D]=i.useState(null),[_,A]=i.useState(null),[B,F]=i.useState(null),[P,$]=i.useState(null),[H,V]=i.useState(null),[I,Q]=i.useState(0),[q,R]=i.useState(0),[z,U]=i.useState("buy"),[G,Z]=i.useState("buy"),Y=i.useMemo((()=>ws(t.id,c.id)),[t,c]);function ee(){v(null),k(null)}i.useEffect((()=>{(async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()).type;let l=z;return("buy"===s||"sell"===s)&&(l=s),{finalType:l}})().then((({finalType:e})=>{e!==z&&U(e)}))}),[]);const se=i.useMemo((()=>Rs([l.chain,r,a,l.id])),[l,r,a,q]),{data:re,loading:ie,error:te}=ts(se);i.useEffect((()=>{!re||ie||te?(v(null),k(null)):(v(re.bids),k(re.asks),C(re.bids),T(re.asks))}),[re,ie,te]);const de=i.useMemo((()=>zs([l.chain,t.id,c.id,l.id])),[l,t,c,I]),{data:ne,loading:ce,error:oe}=ts(de);i.useEffect((()=>{!ne||ce||oe?(D(null),A(null),F(null),$(null),V(null)):(D(ne.balances),A(ne.accountLimitOrders),F(ne.marketHistory),$(ne.usrTrades),V(ne.ticker))}),[ne,ce,oe]);const me={backgroundColor:"#252526",color:"white"},[xe,he]=i.useState(!1),ue=e.jsxs(Re,{children:[e.jsx(ze,{asChild:!0,style:{position:"relative"},children:e.jsxs(J,{className:"mt-5",children:[e.jsxs(W,{className:"pt-4 pb-2",children:[e.jsx(X,{children:p("Market:marketSummary")}),e.jsxs(K,{className:"text-lg",children:["buy"===z?`${r}/${a}`:null,"sell"===z?`${a}/${r}`:null]})]}),e.jsx(ae,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:latestPrice")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:H&&t?He(H.latest,t.precision):"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrChange")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:H?H.percent_change:"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrBaseVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsxs(E,{variant:"outline",className:"ml-2 mb-1",children:[H?null:"?","buy"===z&&H?H.base_volume:null,"sell"===z&&H?H.quote_volume:null]})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrQuoteVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsxs(E,{variant:"outline",className:"ml-2 mb-1",children:[H?null:"?","buy"===z&&H?H.quote_volume:null,"sell"===z&&H?H.base_volume:null]})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:lowestAsk")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:H&&t?He(H.lowest_ask,t.precision):"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:highestBid")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2",children:H&&t?He(H.highest_bid,t.precision):"?"})})]})]})})]})}),e.jsxs(Qe,{className:"w-80 text-sm text-center",children:[e.jsxs("b",{children:[r,"/",a," ",p("Market:externalMarketLinks")]}),e.jsx("br",{}),e.jsx(Ue,{variant:"outline",classnamecontents:"mb-2 mt-2",type:"button",text:p("Market:blocksightsMarketExplorer"),hyperlink:"bitshares"===l.chain?`https://blocksights.info/#/markets/${"buy"===z?r:a}/${"buy"===z?a:r}`:`https://blocksights.info/#/markets/${"buy"===z?r:a}/${"buy"===z?a:r}?network=testnet`}),"bitshares"===l.chain?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{variant:"outline",classnamecontents:"ml-2",type:"button",text:"ðŸ”— BTS.Exchange",hyperlink:"buy"===z?`https://bts.exchange/#/market/${r}_${a}?r=nftprofessional1`:`https://bts.exchange/#/market/${a}_${r}?r=nftprofessional1`}),e.jsx(Ue,{variant:"outline",classnamecontents:"ml-2 mt-2",type:"button",text:"ðŸ”— XBTS",hyperlink:"buy"===z?`https://ex.xbts.io/market/${r}_${a}?r=nftprofessional1`:`https://ex.xbts.io/market/${a}_${r}?r=nftprofessional1`})]}):null]})]});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsxs(Se,{defaultValue:z,value:z,className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:[t&&c?null:e.jsxs(e.Fragment,{children:[e.jsx(S,{disabled:!0,value:"buy",style:me,children:p("Market:buy")}),e.jsx(S,{disabled:!0,value:"sell",children:p("Market:sell")})]}),t&&c&&"buy"===z?e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"buy",style:me,children:p("Market:buy")}),e.jsx(S,{value:"sell",onClick:()=>{U("sell"),window.history.replaceState({},"",`${window.location.pathname}?${new URLSearchParams({...new URLSearchParams(window.location.search),price:0}).toString()}`)},children:p("Market:sell")})]}):null,t&&c&&"sell"===z?e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"buy",onClick:()=>{U("buy"),window.history.replaceState({},"",`${window.location.pathname}?${new URLSearchParams({...new URLSearchParams(window.location.search),price:0,amount:0}).toString()}`)},children:p("Market:buy")}),e.jsx(S,{value:"sell",style:me,children:p("Market:sell")})]}):null]}),e.jsx(le,{value:"buy",children:e.jsx(ys,{usr:l,thisAssetA:r,thisAssetB:a,assetAData:t,assetBData:c,buyOrders:N,sellOrders:f,usrBalances:L,orderType:"buy",marketSearch:g,fee:x,invertedMarket:Y},"buyLimit")}),e.jsx(le,{value:"sell",children:e.jsx(ys,{usr:l,thisAssetA:r,thisAssetB:a,assetAData:t,assetBData:c,buyOrders:N,sellOrders:f,usrBalances:L,orderType:"sell",marketSearch:g,fee:x,invertedMarket:Y},"sellLimit")})]}),H&&t&&c?null:e.jsxs(J,{className:"mt-5",children:[e.jsxs(W,{className:"pt-4 pb-2",children:[e.jsx(X,{children:p("Market:marketSummary")}),e.jsx(K,{className:"text-lg",children:"â”/â”"})]}),e.jsx(ae,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:latestPrice")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrChange")}),e.jsx("div",{className:"col-span-3",children:"â”"})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrBaseVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:24HrQuoteVolume")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:lowestAsk")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:p("Market:highestBid")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2",children:"â”"})})]})]})})]}),H&&t&&c?ue:null]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs(J,{children:[e.jsx(W,{className:"pt-2 pb-2",children:e.jsxs(X,{className:"text-center text-lg",children:["bitshares"===l.chain?"Bitshares ":"Bitshares (Testnet) ",p("Market:controls")]})}),e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(ps,{assetSymbol:r,assetData:t,storeCallback:h,otherAsset:a,marketSearch:g,type:"buy"===z?"quote":"base",size:"small"}),e.jsx("a",{style:{lineHeight:1},href:`/dex/index.html?market=${a}_${r}`,onClick:()=>he(!0),children:e.jsx(be,{variant:"outline",className:"w-full h-7",children:xe?e.jsx(Ye,{className:"animate-spin"}):e.jsx(Ye,{})})}),e.jsx(ps,{assetSymbol:a,assetData:c,storeCallback:u,otherAsset:r,marketSearch:g,type:"sell"===z?"quote":"base",size:"small"})]})})]})}),e.jsx("div",{className:"flex-grow",style:{paddingBottom:"0px"},children:d?e.jsx(js,{asset:r,assetData:t,assetDetails:d,bitassetData:n,marketSearch:g,chain:l.chain,usrBalances:L,type:"buy"===z?"buy":"sell"}):e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(X,{children:p("buy"===z?"Market:quoteAsset":"Market:baseAsset")}),e.jsx(K,{className:"text-lg",children:p("Market:loading")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"}),e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"})]})})]})}),e.jsx("div",{className:"flex-grow",children:o?e.jsx(js,{asset:a,assetData:c,assetDetails:o,bitassetData:m,marketSearch:g,chain:l.chain,usrBalances:L,type:"sell"===z?"buy":"sell"}):e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(X,{children:p("sell"===z?"Market:baseAsset":"Market:quoteAsset")}),e.jsx(K,{className:"text-lg",children:p("Market:loading")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"}),e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"})]})})]})})]})})]}),r&&a&&t&&c?e.jsx(qs,{assetA:r,assetAData:t,assetB:a,assetBData:c,chain:l.chain}):null,e.jsx("div",{className:"grid grid-cols-1 gap-5 mt-5",children:t&&c?e.jsx(e.Fragment,{children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-1",children:["buy"===G?e.jsx(S,{value:"buy",style:me,children:p("Market:buyOrders")}):e.jsx(S,{value:"buy",onClick:()=>Z("buy"),children:p("Market:buyOrders")}),"sell"===G?e.jsx(S,{value:"sell",style:me,children:p("Market:sellOrders")}):e.jsx(S,{value:"sell",onClick:()=>Z("sell"),children:p("Market:sellOrders")})]}),e.jsx(le,{value:"buy",children:e.jsx(Ns,{cardType:"buy",activeLimitCard:z,assetA:r,assetAData:t,assetB:a,assetBData:c,buyOrders:N,previousBuyOrders:O,sellOrders:f,previousSellOrders:M,marketOrdersLoading:ie,orderBookItr:q,setOrderBookItr:R,_resetOrders:ee,invertedMarket:Y})}),e.jsx(le,{value:"sell",children:e.jsx(Ns,{cardType:"sell",activeLimitCard:z,assetA:r,assetAData:t,assetB:a,assetBData:c,buyOrders:N,previousBuyOrders:O,sellOrders:f,previousSellOrders:M,marketOrdersLoading:ie,orderBookItr:q,setOrderBookItr:R,_resetOrders:ee,invertedMarket:Y})})]})}):null}),r&&a?e.jsx(Xs,{activeLimitCard:z,assetAData:t,assetBData:c,usr:l,marketItr:I,setMarketItr:Q,usrLimitOrders:_,publicMarketHistory:B,usrHistory:P,_resetMarketData:function(){D(null),A(null),F(null),$(null),V(null)}}):null]})})}function Ks(s){const{t:l,i18n:r}=ge(fe.get(),{i18n:ye}),a={backgroundColor:"#252526",color:"white"};return e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:[e.jsx(S,{disabled:!0,value:"buy",style:a,children:l("MarketPlaceholder:buyTab")}),e.jsx(S,{disabled:!0,value:"sell",children:l("MarketPlaceholder:sellTab")})]}),e.jsx(le,{value:"buy",children:e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2",children:[e.jsx(X,{children:l("MarketPlaceholder:marketLimitOrderFormTitle")}),e.jsx(K,{children:l("MarketPlaceholder:marketLimitOrderFormDescription")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:l("MarketPlaceholder:priceLabel")}),e.jsx("div",{className:"text-gray-500 text-right",children:e.jsx("span",{variant:"link",children:"?"})})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:pricePerAsset")}),e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:l("MarketPlaceholder:amountLabel")}),e.jsx("div",{className:"text-gray-500 text-right",children:"?"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:amountDescription")}),e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:l("MarketPlaceholder:totalLabel")}),e.jsx("div",{className:"text-gray-500 text-right",children:"?"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:totalDescription")}),e.jsx("div",{className:"text-sm col-span-1 mt-2",children:l("MarketPlaceholder:expirationLabel")}),e.jsx("div",{className:"col-span-1",children:e.jsx(Ze,{disabled:!0,children:e.jsx(es,{className:"mb-3",children:e.jsx(ss,{placeholder:l("MarketPlaceholder:expirationPlaceholder")})})})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:expirationDescription")}),e.jsx("div",{className:"text-sm col-span-1",children:l("MarketPlaceholder:feeLabel")}),e.jsx("div",{className:"col-span-1",children:e.jsx(Q,{disabled:!0,label:l("MarketPlaceholder:feeInputLabel")})}),e.jsx("div",{className:"col-span-1 text-sm",children:l("MarketPlaceholder:feeDescription")}),e.jsx("div",{className:"col-span-1",children:e.jsx(be,{disabled:!0,className:"mt-4 mb-1",variant:"outline",type:"submit",children:l("MarketPlaceholder:submitButton")})})]})})]})})]}),e.jsxs(J,{className:"mt-5",children:[e.jsxs(W,{className:"pt-4 pb-2",children:[e.jsx(X,{children:l("MarketPlaceholder:marketSummaryTitle")}),e.jsx(K,{className:"text-lg",children:"â”/â”"})]}),e.jsx(ae,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:latestPriceLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:24HrChangeLabel")}),e.jsx("div",{className:"col-span-3",children:"â”"})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:24HrBaseVolumeLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:24HrQuoteVolumeLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:lowestAskLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2 mb-1",children:"â”"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:l("MarketPlaceholder:highestBidLabel")}),e.jsx("div",{className:"col-span-3",children:e.jsx(E,{variant:"outline",className:"ml-2",children:"â”"})})]})]})})]})]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs(J,{children:[e.jsx(W,{className:"pt-2 pb-2",children:e.jsx(X,{className:"text-center text-lg",children:l("MarketPlaceholder:dexMarketControlsTitle")})}),e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(be,{variant:"outline",className:"h-5 p-3",children:"â”"}),e.jsx(be,{variant:"outline",className:"w-full h-5 p-3",children:e.jsx(Ye,{})}),e.jsx(be,{variant:"outline",className:"h-5 p-3",children:"â”"})]})})]})}),e.jsx("div",{className:"flex-grow",style:{paddingBottom:"0px"},children:e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(X,{children:l("MarketPlaceholder:assetCardTitle",{asset:"?"})}),e.jsx(K,{className:"text-lg",children:l("MarketPlaceholder:loadingAssetDescription")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"}),e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"})]})})]})}),e.jsx("div",{className:"flex-grow",children:e.jsxs(J,{children:[e.jsxs(W,{className:"pb-2 pt-4",children:[e.jsx(X,{children:l("MarketPlaceholder:assetCardTitle",{asset:"?"})}),e.jsx(K,{className:"text-lg",children:l("MarketPlaceholder:loadingAssetDescription")})]}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"}),e.jsx(w,{className:"h-4 w-[250px]"}),e.jsx(w,{className:"h-4 w-[200px]"})]})})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mt-5",children:[e.jsx(J,{children:e.jsxs(W,{className:"pb-2",children:[e.jsx(X,{children:"?"}),e.jsx(K,{children:l("MarketPlaceholder:loadingAssetDescription")})]})}),e.jsx(J,{children:e.jsxs(W,{className:"pb-2",children:[e.jsx(X,{children:"?"}),e.jsx(K,{children:l("MarketPlaceholder:loadingAssetDescription")})]})}),e.jsx(J,{children:e.jsxs(W,{className:"pb-2",children:[e.jsx(X,{children:"?"}),e.jsx(K,{children:l("MarketPlaceholder:loadingAssetDescription")})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-5 mt-5",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-1",children:[e.jsx(S,{value:"buy",style:a,children:l("MarketPlaceholder:buyTabTitle")}),e.jsx(S,{value:"sell",children:l("MarketPlaceholder:sellTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsx(J,{children:e.jsxs(W,{children:[e.jsx(X,{children:l("MarketPlaceholder:loadingMarketOrdersTitle")}),e.jsx(K,{children:l("MarketPlaceholder:loadingMarketOrdersDescription")}),e.jsxs(ae,{children:[e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"})]}),e.jsx(Ps,{children:e.jsx(be,{className:"mt-5",children:l("MarketPlaceholder:retryRequestButton")})})]})})})]})}),e.jsx("div",{className:"grid grid-cols-1 mt-5",children:e.jsxs(Se,{defaultValue:"marketTrades",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-3 gap-2",children:[e.jsx(S,{value:"marketTrades",style:a,children:l("MarketPlaceholder:marketTradesTabTitle")}),e.jsx(S,{value:"usrHistory",children:l("MarketPlaceholder:yourTradesTabTitle")}),e.jsx(S,{value:"usrLimitOrders",children:l("MarketPlaceholder:yourOpenOrdersTabTitle")})]}),e.jsx(le,{value:"marketTrades",children:e.jsxs(Se,{defaultValue:"buy",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-2 gap-2",children:[e.jsx(S,{value:"buy",style:a,children:l("MarketPlaceholder:buyOrdersTabTitle")}),e.jsx(S,{value:"sell",children:l("MarketPlaceholder:sellOrdersTabTitle")})]}),e.jsx(le,{value:"buy",children:e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(X,{children:l("MarketPlaceholder:completedOrdersTitle",{asset:"?"})}),e.jsx(K,{children:l("MarketPlaceholder:recentlyCompletedOrdersDescription")})]}),e.jsxs(ae,{className:"space-y-2",children:[e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"}),e.jsx(w,{className:"h-4 w-full mt-1"})]})]})})]})})]})})]})}function wr(s){ge(fe.get(),{i18n:ye});const l=i.useSyncExternalStore(os.subscribe,os.get,(()=>!0)),r=i.useSyncExternalStore(is.subscribe,is.get,(()=>!0)),a=i.useSyncExternalStore(ns.subscribe,ns.get,(()=>!0)),t=i.useSyncExternalStore(cs.subscribe,cs.get,(()=>!0)),d=i.useSyncExternalStore(ds.subscribe,ds.get,(()=>!0)),n=i.useSyncExternalStore(Ie.subscribe,Ie.get,(()=>!0)),c=i.useSyncExternalStore(qe.subscribe,qe.get,(()=>!0)),o=i.useMemo((()=>l&&l.chain?l.chain:"bitshares"),[l]);Bs(o??"bitshares",["assets","globalParams","marketSearch","pools"]);const m=i.useMemo((()=>o&&(r||a)?"bitshares"===o?r:a:[]),[r,a,o]),x=i.useMemo((()=>o&&(t||d)?"bitshares"===o?t:d:[]),[t,d,o]),h=i.useMemo((()=>o&&(n||c)?"bitshares"===o?n:c:[]),[n,c,o]),[u,p]=i.useState(0);i.useEffect((()=>{if(x&&x.parameters){const e=x.find((e=>1===e[0])),s=ke(e[1].fee,5);p(s)}}),[x]);const j=i.useMemo((()=>h.map((e=>e.s))),[h]),b=i.useMemo((()=>h.map((e=>e.id))),[h]),[y,g]=i.useState(window.location.search?null:"BTS"),[N,v]=i.useState(window.location.search?null:"USD");i.useEffect((()=>{h&&h.length&&window.location.search&&async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()).market;let l=y,r=N;if(s&&s.length){let e=s.split("_")[0].toUpperCase(),a=s.split("_")[1].toUpperCase();if(e&&a&&a.length&&e===a&&(a="BTS"===e?"USD":"1.3.0",console.log("Invalid market parameters - replaced quote asset.")),(!e||!e.length||!j.includes(e)&&!b.includes(e))&&(console.log("Asset A replaced with default."),l="1.3.0"),!l){const s=h.find((s=>s.id===e||s.s===e));s?l=s.s:(console.log("Setting default asset A"),l="1.3.0")}if((!a||!a.length||!j.includes(a)&&!b.includes(a))&&(console.log("Asset B replaced with default."),r="USD"!==l?"USD":"1.3.0"),!r){const s=h.find((e=>e.id===a||e.s===a));s?r=s.s:(console.log("Setting default asset B"),r="BTS"!==e&&"1.3.0"!==e?"1.3.0":"USD")}}else console.log("No market parameters found."),l="1.3.0",r="USD";return{finalAssetA:l,finalAssetB:r}}().then((({finalAssetA:e,finalAssetB:s})=>{g(e),v(s)}))}),[h]);const[f,k]=i.useState(null),[O,S]=i.useState(null),[C,w]=i.useState(null),[M,T]=i.useState(null),[L,D]=i.useState(null),[_,A]=i.useState(null);return i.useEffect((()=>{let e;if(y&&l&&l.chain){if(k(null),w(null),D(null),m&&m.length){const e=m.find((e=>e.s===y));if(e)return void k(e)}e=bs([l.chain,y]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&k(e)}))}return()=>{e&&e()}}),[y,l]),i.useEffect((()=>{let e;if(N&&l&&l.chain){if(S(null),T(null),A(null),m&&m.length){const e=m.find((e=>e.s===N));if(e)return void S(e)}e=bs([l.chain,N]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&S(e)}))}return()=>{e&&e()}}),[N,l]),i.useEffect((()=>{let e,s;return f&&l&&l.chain&&(e=gs([l.chain,f.id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&w(e)})),f.bitasset_data_id&&(s=fs([l.chain,f.bitasset_data_id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&D(e)})))),()=>{e&&e(),s&&s()}}),[f,l]),i.useEffect((()=>{let e,s;return O&&l&&l.chain&&(e=gs([l.chain,O.id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&T(e)})),O.bitasset_data_id&&(s=fs([l.chain,O.bitasset_data_id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&A(e)})))),()=>{e&&e(),s&&s()}}),[O,l]),e.jsx(e.Fragment,{children:e.jsx("div",{className:"container mx-auto mt-5 mb-5",children:l&&l.chain&&y&&N&&f&&O&&C&&M?e.jsx(e.Fragment,{children:e.jsx(Gs,{usr:l,assetA:y,assetB:N,assetAData:f,assetADetails:C,assetABitassetData:L,assetBData:O,assetBDetails:M,assetBBitassetData:_,limitOrderFee:u,setAssetA:e=>{g(e)},setAssetB:e=>{v(e)}},`Market_${y}_${N}`)}):e.jsx(Ks,{})})})}export{wr as default};