import{u as e,I as je,v as Ts,V as Fs,L as vs,N as Ns,O as ks,P as Ss,Q as ws,S as _s,K as Xe}from"./button.py8r9pgQ.js";import{r as t}from"./index.vR8cGMCg.js";import{C as z,b as Y,c as Q,d as W,k as se,I as V,H as Ee,a as Ue,e as qe,i as Ie,j as Ve,z as ss,l as As,$ as ls,m as rs,n as as,o as ts,p as is,u as Bs,f as Ds}from"./CurrentUser.9PQ1vVJE.js";import{B as H}from"./badge.pYgHolp0.js";import{S as A,M as ns}from"./MarketAssetCard.nfHyvGck.js";import{d as cs,t as Pe,e as He,h as me,f as $s,i as Re,T as ge,a as ye,b as k,c as ee}from"./common.X_7DDhag.js";import{u as Cs,F as ds,a as re,b as ae,c as ne,f as te,d as be,e as pe}from"./form.nkNC4OVI.js";import{S as We,a as Je,b as Ke,c as Os,d as Fe}from"./select.tdaGh0LQ.js";import{f as Ps,C as Ms}from"./calendar.LvMZ4ZUj.js";import{P as De,a as Ce,b as Oe,c as ze,C as os,S as ms}from"./checkbox.FFWN2b7h.js";import{L as fe,D as Ls}from"./DeepLinkDialog.4TPOcm9S.js";import{F as Hs}from"./index.esm.8fBdem9M.js";import{A as us}from"./AssetDropDownCard.d-y96wRS.js";import{S as Ye}from"./scroll-area.d4DgCtw2.js";import{E as Me}from"./ExternalLink.T2a5i_k0.js";import{P as Es}from"./PoolDialogs.j-U-Fdnr.js";import{b as Us,d as qs}from"./Market.e8Q3QEca.js";import{d as hs,a as xs,b as ps}from"./CardRow.5dmyKKIZ.js";import"./index.7dNGbZe0.js";import"./index.f2GGseSc.js";import"./index.TKWSAka7.js";import"./fuse.aCsZfKX4.js";function js(s){const{usr:l,thisAssetA:a,thisAssetB:r,assetAData:i,assetBData:n,orderType:c,marketSearch:d,usrBalances:o,fee:m,invertedMarket:x}=s,{buyOrders:h,sellOrders:u}=s,[j,p]=t.useState(0),[b,g]=t.useState(0),[y,f]=t.useState(0),N=t.useMemo((()=>{let e=0;if(j&&b&&y){if("buy"===c&&i&&i.market_fee_percent&&i.market_fee_percent>0)return e=parseFloat(j)*(i.market_fee_percent/100),e.toFixed(i.precision);if("sell"===c&&n&&n.market_fee_percent&&n.market_fee_percent>0)return e=parseFloat(y)*(n.market_fee_percent/100),e.toFixed(n.precision)}return e}),[j,b,y,c,i,n]),[v,k]=t.useState("1hr"),[w,S]=t.useState((()=>{const e=new Date;return new Date(e.getTime()+36e5)})),[$,_]=t.useState(new Date(Date.now()+6048e5));t.useEffect((()=>{"specific"===v&&$&&S($)}),[v,$]);const A=Cs({defaultValues:{account:""}}),[D,F]=t.useState(!1);function B(e,s){const l=e.id,a=s.find((e=>e.asset_id===l));return a?me(a.amount,e.precision).toLocaleString(void 0,{minimumFractionDigits:e.precision}):0}const T=t.useMemo((()=>i&&o?B(i,o):0),[i,o]),O=t.useMemo((()=>n&&o?B(n,o):0),[n,o]),[P,C]=t.useState(!1),[M,L]=t.useState(1),[E,U]=t.useState(100),[q,I]=t.useState(1e6),[R,X]=t.useState(!1);t.useEffect((()=>{d&&d.length&&window.location.search&&async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()),l=s.amount,a=s.price,r=s.oso,t=s.spreadPercent,c=s.sizePercent,d=s.expirationSeconds,o=s.repeat;let m=j,x=b,h=y,u=P,p=M,g=E,f=q,N=R;const v=me(1,i.precision),k=me(1,n.precision);if(l){const e=parseFloat(l);e&&(m=e>=v?e:v)}if(a){const e=parseFloat(a);e&&(x=e>=k?e:k)}if(m&&x){const e=parseFloat((m*x).toFixed(n.precision));h=e>=k?e:k}if(r){const e="true"===r;e&&(u=e)}if(t){const e=parseFloat(t);e&&e>=0&&e<=100?p=parseFloat(e.toFixed(3)):e&&e>100?p=100:e&&e<0&&(p=0)}if(c){const e=parseFloat(c);e&&e>=0&&e<=100?g=parseFloat(e.toFixed(3)):e&&e>100?g=100:e&&e<0&&(g=0)}if(d){const e=parseFloat(d);e&&(f=e)}if(o){const e="true"===o;e&&(N=e)}return{finalAmount:m,finalPrice:x,finalTotal:h,finalOSO:u,finalSpreadPercent:p,finalSizePercent:g,finalExpirationSeconds:f,finalRepeat:N}}().then((({finalAmount:e,finalPrice:s,finalTotal:l,finalOSO:i,finalSpreadPercent:t,finalSizePercent:n,finalExpirationSeconds:d,finalRepeat:o})=>{e!==j&&p(e),s!==b&&g(s),l!==y&&f(l),i!==P&&C(i),t!==M&&L(t),n!==E&&U(n),d!==q&&I(d),o!==R&&X(o);let m=`?market=${a}_${r}&type=${c}&price=${s}&amount=${e}`;i&&(m+=`&oso=${i}&spreadPercent=${t}&sizePercent=${n}&expirationSeconds=${d}&repeat=${o}`),window.history.replaceState({},"",m)}))}),[]);const[K,J]=t.useState(0);t.useEffect((()=>{if(K>0){let e=`?market=${a}_${r}&type=${c}&price=${b}&amount=${j}`;P&&(e+=`&oso=${P}&spreadPercent=${M}&sizePercent=${E}&expirationSeconds=${q}&repeat=${R}`),window.history.replaceState({},"",e)}}),[j,b,y,P,M,E,q,R]);const G=t.useCallback(cs(((e,s)=>{/^[0-9]*\.?[0-9]*$/.test(e)&&e>=0&&e<=100&&(L(e),J(K+1))}),25),[]),Z=t.useCallback(cs(((e,s)=>{/^[0-9]*\.?[0-9]*$/.test(e)&&e>=0&&e<=100&&(U(e),J(K+1))}),25),[]);return e.jsxs(z,{children:[e.jsxs(Y,{className:"pb-2",children:[e.jsx(Q,{children:"buy"===c?`Buying ${a} with ${r}`:`Selling ${a} for ${r}`}),e.jsx(W,{children:"Use this form to create a limit order operation."})]}),e.jsxs(se,{children:[a&&r&&d&&i&&n?e.jsx(ds,{...A,children:e.jsxs("form",{onSubmit:e=>{F(!0),e.preventDefault()},children:[e.jsx(re,{control:A.control,name:"priceAmount",render:({field:s})=>e.jsxs(ae,{className:"mt-4 text-xs",children:[e.jsx(ne,{children:"Price"}),e.jsxs(te,{children:["The price of ",a," in ",r]}),e.jsx(be,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(V,{label:"Price",placeholder:b,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(De,{children:[e.jsx(Ce,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(fe,{children:"Edit"})})}),e.jsxs(Oe,{children:[e.jsx(fe,{children:"Provide a new price"}),e.jsx(V,{placeholder:b,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(g(e.toFixed("buy"===c?n.precision:i.precision)),j&&f((e*j).toFixed("buy"===c?n.precision:i.precision)),J(K+1))}}}),"buy"===c&&!u||u&&!u.length||"sell"===c&&!h||h&&!h.length?e.jsx(H,{disabled:!0,children:"buy"===c?"Use lowest ask":"Use highest bid"}):e.jsx("span",{variant:"link",onClick:e=>{let s;e.preventDefault(),"buy"===c&&u&&u.length>0?s=Pe(parseFloat(u[0].price),n.precision):"sell"===c&&h&&h.length>0&&(s=Pe(parseFloat(h[0].price),n.precision)),s&&(g(parseFloat(s).toFixed(n.precision)),j&&f((parseFloat(s)*parseFloat(j)).toFixed(n.precision)),J(K+1))},children:e.jsx(H,{children:"buy"===c?"Use lowest ask":"Use highest bid"})})]})]})})]})}),e.jsx(pe,{})]})}),e.jsx(re,{control:A.control,name:"sellAmount",render:({field:s})=>e.jsxs(ae,{className:"mt-4 text-xs",children:[e.jsx(ne,{children:"Amount"}),e.jsx(te,{children:"buy"===c?`The amount of ${a} you plan on buying`:`The amount of ${a} you plan on selling`}),e.jsx(be,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(V,{label:"Amount",placeholder:j,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(De,{children:[e.jsx(Ce,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(fe,{children:"Edit"})})}),e.jsxs(Oe,{children:[e.jsx(fe,{children:"Provide a new amount"}),e.jsx(V,{placeholder:j,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(p(e.toFixed(i.precision)),b&&f((e*b).toFixed(n.precision)),J(K+1))}}}),"sell"===c&&T?e.jsx(H,{onClick:()=>{let e=parseFloat(T.replaceAll(",",""));e&&(p(e.toFixed(i.precision)),b&&f((e*b).toFixed(n.precision)),J(K+1))},children:"Use balance"}):null]})]})})]})})]})}),e.jsx(re,{control:A.control,name:"sellTotal",render:({field:s})=>e.jsxs(ae,{className:"mt-4 text-xs",children:[e.jsx(ne,{children:"Total"}),e.jsx(te,{children:"buy"===c?`The total ${r} you plan on selling`:`The total ${r} you will receive`}),e.jsx(be,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsx("span",{className:"col-span-9",children:e.jsx(V,{label:"Total",placeholder:y,disabled:!0,readOnly:!0})}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(De,{children:[e.jsx(Ce,{children:e.jsx("span",{className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(fe,{children:"Edit"})})}),e.jsxs(Oe,{children:[e.jsx(fe,{children:"Provide a new total"}),e.jsx(V,{placeholder:y,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;if(s&&s.length&&/^[0-9,]*\.?[0-9]*$/.test(s)){const e=parseFloat(s.replaceAll(",",""));e&&(f(e.toFixed(n.precision)),b&&p((e/b).toFixed(i.precision)),J(K+1))}}}),"buy"===c&&O?e.jsx(H,{onClick:()=>{let e=parseFloat(O.replaceAll(",",""));e&&(f(e.toFixed(n.precision)),b&&p((e/b).toFixed(i.precision)),J(K+1))},children:"Use balance"}):null]})]})})]})}),j&&b&&O&&parseFloat(O.replaceAll(",",""))<parseFloat(y)?e.jsx(pe,{children:`You require \n                          ${y-parseFloat(O.replaceAll(",","")).toFixed(n.precision)}\n                          more ${r}`}):null]})}),e.jsx(re,{control:A.control,name:"expiry",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Limit order expriration"}),e.jsx(be,{onValueChange:e=>{k(e);const s=36e5,l=24*s;if("specific"!==e&&"fkill"!==e){const a=new Date;let r;if("1hr"===e)r=new Date(a.getTime()+s);else if("12hr"===e){const e=12*s;r=new Date(a.getTime()+e)}else if("24hr"===e){const e=l;r=new Date(a.getTime()+e)}else if("7d"===e){const e=7*l;r=new Date(a.getTime()+e)}else if("30d"===e){const e=30*l;r=new Date(a.getTime()+e)}r&&_(r),S(e)}else if("fkill"===e){const e=new Date;S(new Date(e.getTime()+l))}else"specific"===e&&S();J(K+1)},children:e.jsxs(We,{children:[e.jsx(Je,{className:"mb-3",children:e.jsx(Ke,{placeholder:"1hr"})}),e.jsxs(Os,{className:"bg-white",children:[e.jsx(Fe,{value:"1hr",children:"1 hour"}),e.jsx(Fe,{value:"12hr",children:"12 hours"}),e.jsx(Fe,{value:"24hr",children:"24 hours"}),e.jsx(Fe,{value:"7d",children:"7 days"}),e.jsx(Fe,{value:"30d",children:"30 days"}),e.jsx(Fe,{value:"specific",children:"Specific date"}),e.jsx(Fe,{value:"fkill",children:"Fill or kill"})]})]})}),e.jsxs(te,{children:["specific"===v?e.jsxs(De,{children:[e.jsx(Ce,{asChild:!0,children:e.jsxs(je,{variant:"outline",className:Ts("w-[240px] justify-start text-left font-normal",!$&&"text-muted-foreground"),children:[e.jsx(Fs,{className:"mr-2 h-4 w-4"}),$?Ps($,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(Oe,{className:"w-auto p-0",align:"start",children:e.jsx(Ms,{mode:"single",selected:$,onSelect:e=>{new Date(e)<new Date?_(new Date(Date.now()+864e5)):_(e)},initialFocus:!0})})]}):null,"fkill"===v?"This order immediately expires if not fillable":null,"specific"!==v&&"fkill"!==v?`This limit order will expire ${v} after broadcast`:null]}),e.jsx(pe,{})]})}),e.jsx(ze,{className:"mb-2 mt-2"}),e.jsx(re,{control:A.control,name:"osoValue",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(be,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"terms1",checked:P,onClick:()=>{C(!P),J(K+1)}}),e.jsx("label",{htmlFor:"terms1",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:P?"Order Sends Order Enabled":"Enable Order Sends Order"})]})}),P?e.jsx(te,{children:"Automatic OSO function will be active"}):null]})}),P?e.jsxs(e.Fragment,{children:[e.jsx(re,{control:A.control,name:"osoSpread",render:({field:s})=>e.jsxs(ae,{className:"mt-2 text-xs",children:[e.jsx(ne,{className:"text-sm",children:"Spread percent"}),e.jsx(te,{children:"How far the price of the take profit order differs from the original order"}),e.jsx(be,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsxs("span",{className:"col-span-9",children:[e.jsx(V,{label:"Spread percent",placeholder:M,disabled:!0,readOnly:!0}),e.jsx(ms,{className:"mt-3",defaultValue:[M],max:100,min:1,step:.01,onValueChange:e=>{G(e[0])}})]}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(De,{children:[e.jsx(Ce,{children:e.jsx("span",{onClick:()=>{event.preventDefault()},className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(fe,{children:"Edit"})})}),e.jsxs(Oe,{children:[e.jsx(fe,{children:"Provide a new spread percent"}),e.jsx(V,{placeholder:M,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;s&&s.length&&/^[0-9]*\.?[0-9]*$/.test(s)&&s>=1&&s<=100&&(L(s),J(K+1))}})]})]})})]})}),e.jsx(pe,{})]})}),e.jsx(re,{control:A.control,name:"osoSize",render:({field:s})=>e.jsxs(ae,{className:"mt-4 text-xs",children:[e.jsx(ne,{className:"text-sm",children:"Size percent"}),e.jsx(te,{children:"Percentage to sell in the take profit order"}),e.jsx(be,{children:e.jsxs("span",{className:"grid grid-cols-12",children:[e.jsxs("span",{className:"col-span-9",children:[e.jsx(V,{label:"Size percent",placeholder:E,disabled:!0,readOnly:!0}),e.jsx(ms,{className:"mt-3",defaultValue:[E],max:100,min:0,step:.01,onValueChange:e=>{Z(e[0])}})]}),e.jsx("span",{className:"col-span-3 ml-3 text-center",children:e.jsxs(De,{children:[e.jsx(Ce,{children:e.jsx("span",{onClick:()=>{event.preventDefault()},className:"inline-block border border-grey rounded pl-4 pb-1 pr-4 text-lg",children:e.jsx(fe,{children:"Edit"})})}),e.jsxs(Oe,{children:[e.jsx(fe,{children:"Provide a new size percent"}),e.jsx(V,{placeholder:E,className:"mb-2 mt-1",onChange:e=>{const s=e.target.value;s&&s.length&&/^[0-9]*\.?[0-9]*$/.test(s)&&s>=0&&s<=100&&(U(s),J(K+1))}})]})]})})]})}),e.jsx(pe,{})]})}),e.jsx(re,{control:A.control,name:"repeatValue",render:({field:s})=>e.jsxs(ae,{className:"mt-4 text-xs",children:[e.jsx(ne,{className:"text-sm",children:"Set OSO to automatically repeat?"}),e.jsx(te,{children:"Automates repeated OSO based limit orders"}),e.jsx(be,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(os,{id:"terms2",checked:R,onClick:()=>{X(!R),J(K+1)}}),e.jsx("label",{htmlFor:"terms2",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:R?"OSO configured to repeat":"OSO configured not to repeat"})]})}),e.jsx(pe,{})]})})]}):null,e.jsx(ze,{className:"mt-3"}),e.jsx(re,{control:A.control,disabled:!0,name:"fee",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Fee"}),e.jsx(te,{children:"The network fee to broadcast this operation"}),e.jsx(be,{children:e.jsx(V,{disabled:!0,label:"fees",value:`${m} BTS`,placeholder:1})}),"fkill"===v||l.id===l.referrer?e.jsxs(pe,{children:["fkill"===v?`Unfilled rebate: ${m} BTS (instant)`:null,e.jsx("br",{}),l.id===l.referrer?`LTM rebate: ${.8*m} BTS (vesting)`:null]}):null]})}),"buy"===c&&i&&i.market_fee_percent&&i.market_fee_percent>0?e.jsx(re,{control:A.control,disabled:!0,name:"marketFees",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Market fee"}),e.jsx(be,{children:e.jsx(V,{disabled:!0,value:`${N} ${i.symbol}`,placeholder:`${N} ${i.symbol}`})}),e.jsx(te,{children:"The market fee applied by asset issuer"})]})}):null,"sell"===c&&n&&n.market_fee_percent&&n.market_fee_percent>0?e.jsx(re,{control:A.control,disabled:!0,name:"marketFees",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Market fee"}),e.jsx(be,{children:e.jsx(V,{disabled:!0,value:`${N} ${n.symbol}`,placeholder:`${N} ${n.symbol}`})}),e.jsx(pe,{}),e.jsx(te,{children:"The market fee applied by asset issuer"})]})}):null,j&&b&&w?e.jsx(je,{className:"mt-7 mb-1",variant:"outline",type:"submit",children:"Submit"}):e.jsx(je,{className:"mt-7 mb-1",variant:"outline",disabled:!0,type:"submit",children:"Submit"})]})}):e.jsx(ds,{...A,children:e.jsxs("form",{children:[e.jsx(re,{control:A.control,name:"sellPrice",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:"Price"}),e.jsx("div",{className:"text-gray-500 text-right",children:e.jsx("span",{variant:"link",children:e.jsx(H,{children:"Use lowest ask"})})})]})}),e.jsx(V,{disabled:!0,className:"mb-3"}),e.jsx(te,{children:"Your price per ? in ?"}),e.jsx(pe,{})]})}),e.jsx(re,{control:A.control,name:"sellAmount",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:"Amount"}),e.jsx("div",{className:"text-gray-500 text-right",children:"sell"===c&&T?e.jsx(H,{children:"Use balance"}):null})]})}),e.jsx(te,{children:"buy"===c?"The amount of ? you plan on buying":"The amount of ? you plan on selling"}),e.jsx(V,{disabled:!0,className:"mb-3"}),e.jsx(pe,{})]})}),e.jsx(re,{control:A.control,name:"sellTotal",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"grid grid-cols-2 mt-3",children:[e.jsx("div",{className:"mt-1",children:"Total"}),e.jsx("div",{className:"text-gray-500 text-right",children:"buy"===c&&O?e.jsx(H,{children:"Use balance"}):null})]})}),e.jsx(te,{children:"buy"===c?"The total ? you plan on selling":"The total ? you will receive"}),e.jsx(V,{disabled:!0,className:"mb-3"})]})}),e.jsx(re,{control:A.control,name:"expiry",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Limit order expriration"}),e.jsx(te,{children:"Time till expiration..."}),e.jsx(We,{disabled:!0,children:e.jsx(Je,{className:"mb-3",children:e.jsx(Ke,{placeholder:"1hr"})})}),e.jsx(pe,{})]})}),e.jsx(re,{control:A.control,disabled:!0,name:"fee",render:({field:s})=>e.jsxs(ae,{children:[e.jsx(ne,{children:"Fee"}),e.jsx(V,{disabled:!0,label:"fees"}),e.jsx(te,{children:"The network fee to broadcast this operation"}),"fkill"===v||l.id===l.referrer?e.jsxs(pe,{children:["fkill"===v?"Unfilled rebate: 0.4826 BTS (instant)":null,l.id===l.referrer?"LTM rebate: 0.38608 BTS (vesting)":null]}):null]})}),e.jsx(je,{disabled:!0,className:"mt-7 mb-1",variant:"outline",type:"submit",children:"Submit"})]})}),D?e.jsx(Ls,{operationName:"limit_order_create",username:l.username,usrChain:l.chain,userID:l.id,dismissCallback:F,headerText:"buy"===c?`Buying ${j} ${a} for ${y} ${r}`:`Selling ${j} ${a} for ${y} ${r}`,trxJSON:"buy"===c?[{seller:l.id,amount_to_sell:{amount:He(y,n.precision).toFixed(0),asset_id:d.find((e=>e.s===r)).id},min_to_receive:{amount:He(j,i.precision).toFixed(0),asset_id:d.find((e=>e.s===a)).id},expiration:w,fill_or_kill:"fkill"===v,extensions:P?{on_fill:[[0,{fee_asset_id:"1.3.0",spread_percent:M?100*M:0,size_percent:E?100*E:0,expiration_seconds:1e9,repeat:R}]]}:{}}]:[{seller:l.id,amount_to_sell:{amount:He(j,i.precision).toFixed(0),asset_id:d.find((e=>e.s===a)).id},min_to_receive:{amount:He(y,n.precision).toFixed(0),asset_id:d.find((e=>e.s===r)).id},expiration:w,fill_or_kill:"fkill"===v,extensions:P?{on_fill:[[0,{fee_asset_id:"1.3.0",spread_percent:M,size_percent:E,expiration_seconds:1e9,repeat:R}]]}:{}}]},"buy"===c?`Buying${j}${a}for${y}${r}`:`Selling${j}${a}for${y}${r}`):null]})]})}function bs(s){const{cardType:l,activeLimitCard:a,assetA:r,assetAData:i,assetB:n,assetBData:c,buyOrders:d,previousBuyOrders:o,sellOrders:m,previousSellOrders:x,marketOrdersLoading:h,orderBookItr:u,setOrderBookItr:j,_resetOrders:p,invertedMarket:b}=s;let g,y,f,N;return!h||d||m||o||o.length||x||x.length?(g="buy"===l?"Open buy limit orders":"Open sell limit orders",y="buy"===l?`The following table displays network offers to purchase ${r} with ${n}`:`The following table displays network offers to sell ${r} for ${n}`,f=({index:s,style:a})=>{let h;"buy"===l&&d?h=d:"buy"===l&&o?h=o:"sell"===l&&m?h=m:"sell"===l&&x&&(h=x);const u=h[s],j=parseFloat(u.price).toFixed(c.precision),p=parseFloat(u.base),b=parseFloat(u.quote),g=h.slice(0,s+1).map((e=>parseFloat(e.base))).reduce(((e,s)=>e+s),0).toFixed(c.precision),y=h.slice(0,s+1).map((e=>parseFloat(e.quote))).reduce(((e,s)=>e+s),0).toFixed(i.precision),f=t.useMemo((()=>"buy"===l?`/dex/index.html?market=${r}_${n}&type=sell&price=${j}&amount=${y}`:`/dex/index.html?market=${r}_${n}&type=buy&price=${j}&amount=${y}`),[r,n,j,g,y]);return e.jsx("div",{style:a,children:e.jsxs(vs,{children:[e.jsx(Ns,{asChild:!0,children:e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-l-2 border-r-2 pl-3",children:j}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?p:b}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?b:p}),e.jsx("div",{className:"col-span-1 pl-3",children:g}),e.jsx("div",{className:"col-span-4",children:e.jsx(ze,{})})]})},`moc_${l}_${s}`)}),e.jsxs(ks,{className:"sm:max-w-[800px] bg-white",children:[e.jsxs(Ss,{children:[e.jsx(ws,{children:"Would you like to proceed with the following limit order data?"}),e.jsxs(_s,{children:["The ","buy"===l?"sell":"buy"," limit order form above will be filled out with the following market order data."]})]}),e.jsx("span",{className:"pt-3",children:"buy"===l?`Selling ${y} ${r} in exchange for at least ${g} ${n}`:`Selling ${g} ${n} in exchange for at least ${y} ${r}`}),e.jsx("span",{children:`Price: ${j} ${n} per 1 ${r}`}),e.jsx("a",{href:f,children:e.jsx(je,{className:"mt-2 h-6",children:"Proceed"})})]})]},`${l}Dialog${s}`)})},N="buy"===l?d?d.length:o.length:m?m.length:x.length):(g="Loading market orders",y="Fetching requested market data, please wait...",f=({index:s,style:a})=>{const r="buy"===l?o:x,t=r&&r.length?r[s]:null,n=t?parseFloat(t.price).toFixed(i.precision):null,c=t?parseFloat(t.base):null,d=t?parseFloat(t.quote):null,m=r&&r.length?r.slice(0,s+1).map((e=>parseFloat(e.base))).reduce(((e,s)=>e+s),0).toFixed(i.precision):null;return e.jsx("div",{style:a,children:e.jsxs(Ee,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-1 border-l-2 border-r-2 pl-3",children:n}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:c}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:d}),e.jsx("div",{className:"col-span-1 pl-3",children:m})]}):e.jsx("div",{className:"col-span-4",children:e.jsx(A,{className:"h-4 w-full"})}),e.jsx("div",{className:"col-span-4",children:e.jsx(ze,{})})]})},`moc_loading_${l}_${s}`)}),e.jsxs(qe,{className:"w-80 text-sm pt-3",children:["Market data is refreshing, please wait...",e.jsx("br",{}),e.jsx(A,{className:"h-4 w-full"})]})]},`loadingOrderHoverCard${s}`)})},N=10),e.jsxs(z,{children:[e.jsxs(Y,{children:[e.jsx(Q,{children:g}),e.jsx(W,{children:y})]}),e.jsxs(se,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:"Price"}),e.jsxs("div",{className:"col-span-1 pl-3 text-md",children:["sell"===l&&r&&r.length<12?r:null,"sell"===l&&r&&r.length>=12&&i?i.id:null,"buy"===l&&n&&n.length<12?n:null,"buy"===l&&n&&n.length>=12&&c?c.id:null]}),e.jsxs("div",{className:"col-span-1 pl-3",children:["sell"===l&&n&&n.length<12?n:null,"sell"===l&&n&&n.length>=12&&c?c.id:null,"buy"===l&&r&&r.length<12?r:null,"buy"===l&&r&&r.length>=12&&i?i.id:null]}),e.jsxs("div",{className:"col-span-1 pl-3",children:[n&&n.length<7?`Total (${n})`:null,n&&n.length>=7&&c?`Total (${c.id})`:null]})]}),e.jsx(Hs,{height:300,itemCount:N,itemSize:20,children:f})]})]})}function Is(s){const{type:l,publicMarketHistory:a,assetAData:r,assetBData:i}=s,n=t.useMemo((()=>a.filter((e=>e.type===l))),[a,l]),c=t.useMemo((()=>n.map(((s,a)=>{const t=s.price.split("."),n=r&&i&&t.length>1?Pe(s.price,"buy"===l?r.precision:i.precision):s.price;return e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:n}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:s.amount}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:$s(s.date)}),e.jsx("div",{className:"col-span-1 border-r-2 border-b-2 pl-3",children:s.value})]})},`ms_${a}_${l}`)}))),[n,r,i,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 pl-3 text-md",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Price"}),e.jsxs("div",{className:"col-span-1 text-sm",children:[r?r.symbol:"?","/",i?i.symbol:"?"]})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Amount"}),e.jsx("div",{className:"col-span-1 text-sm",children:r?r.symbol:"?"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Date"}),e.jsx("div",{className:"col-span-1 text-sm",children:"Time since trade"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsx("div",{className:"col-span-1",children:"Total value"}),e.jsx("div",{className:"col-span-1 text-sm",children:i?i.symbol:"?"})]})})]}),e.jsx(Ye,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-4",children:c.length?c:null})})]})}function fs(s){const{type:l,publicMarketHistory:a,marketHistoryInProgress:r,reset:i,assetAData:t,assetBData:n}=s;return e.jsxs(z,{children:[e.jsxs(Y,{children:[e.jsx(Q,{children:"buy"===l?"Recently completed market buy orders":"Recently completed market sell orders"}),e.jsx(W,{children:"buy"===l?"The table below lists recently completed buy orders on the Bitshares DEX":"The table below lists recently completed sell orders on the Bitshares DEX"})]}),e.jsxs(se,{className:"space-y-2",children:[r?e.jsx(A,{count:5}):null,a&&a.length?e.jsx(Is,{type:l,publicMarketHistory:a,assetAData:t,assetBData:n}):"No market history found"]})]})}function Vs(s){const{type:l,assetAData:a,assetBData:r,usrLimitOrders:i}=s,n=t.useMemo((()=>i.filter((e=>"buy"===l?e.sell_price.base.asset_id===a.id:e.sell_price.base.asset_id===r.id)).map((e=>{const s=[a,r].find((s=>s.id===e.sell_price.base.asset_id)).precision,i=[a,r].find((s=>s.id===e.sell_price.quote.asset_id)).precision,t=Re(e.sell_price.base.asset_id,e.sell_price.quote.asset_id);me(1,s),me(1,i);let n=me(e.sell_price.base.amount,s),c=me(e.sell_price.quote.amount,i),d=parseFloat(t?n/c:n*c),o=0,m=0;const x=me(e.for_sale,s);return"buy"!==l||t?"buy"===l&&t?(o=(d*x).toFixed(s),m=x.toFixed(i)):"sell"!==l||t?"sell"===l&&t&&(o=(x/d).toFixed(i),m=x.toFixed(s)):(o=x.toFixed(i),m=(d*x).toFixed(s)):(m=(d*x).toFixed(i),o=x.toFixed(s)),{...e,price:d,paying:m,receiving:o,basePrecision:s,quotePrecision:i}})).sort(((e,s)=>e.price-s.price))),[i,l,a,r]),c=t.useMemo((()=>n.map(((s,a)=>{const r=me(1,s.basePrecision),i=me(1,s.quotePrecision);return e.jsxs(vs,{children:[e.jsx(Ns,{asChild:!0,children:e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"grid grid-cols-4 border-b-2 text-sm",children:[e.jsxs("div",{className:"col-span-1 border-r-2 pl-3",children:["buy"===l&&s.price<i?e.jsxs(Ee,{children:[e.jsx(Ue,{children:`< ${i}`}),e.jsx(qe,{className:"w-"+5*s.quotePrecision,children:s.price})]},`hover_less_than_min_${s.id.replace("1.7.","")}`):null,"sell"===l&&s.price<r?e.jsxs(Ee,{children:[e.jsx(Ue,{children:`< ${r}`}),e.jsx(qe,{className:"w-"+5*s.basePrecision,children:s.price})]},`hover_less_than_min_${s.id.replace("1.7.","")}`):null,"buy"===l&&s.price>=i?s.price.toFixed(s.quotePrecision):null,"sell"===l&&s.price>=r?s.price.toFixed(s.basePrecision):null]}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.receiving}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.paying}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.expiration.replace("T"," ")})]})},`mos_${a}_${l}`)}),e.jsxs(ks,{className:"sm:max-w-[600px] bg-white",children:[e.jsxs(Ss,{children:[e.jsx(ws,{children:"Want to edit this limit order?"}),e.jsx(_s,{children:"Limit orders can now be updated, save on fees by updating limit orders."})]}),e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsxs("div",{className:"col-span-1",children:["Selected open order's data:",e.jsx(Ye,{className:"h-72 rounded-md border text-sm",children:e.jsx("pre",{children:JSON.stringify(s,null,2)})})]}),e.jsxs("div",{className:"col-span-1 text-left mt-5",children:[e.jsx("a",{href:`/order/index.html?id=${s.id}`,children:e.jsx(je,{variant:"outline",className:"mt-2 mr-2",children:"Proceed to update this open limit order"})}),e.jsx(Me,{variant:"outline",classnamecontents:"",type:"button",text:"View object on blocksights.info",hyperlink:`https://blocksights.info/#/objects/${s.id}`})]})]})]})]},`${l}Dialog${a}`)}))),[n,a,r,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:"Price"}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:a.symbol}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:r.symbol}),e.jsx("div",{className:"col-span-1 pl-3",children:"Expiration date"})]}),e.jsx(Ye,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-3",children:c})})]})}function gs(s){const{type:l,assetAData:a,assetBData:r,usrLimitOrders:i,usrHistory:n,marketHistoryInProgress:c,reset:d}=s,o=t.useMemo((()=>i&&i.length?"buy"===l?i.filter((e=>e.sell_price.quote.asset_id===r.id)):i.filter((e=>e.sell_price.quote.asset_id===a.id)):i?[]:null),[i,l,a,r]);return e.jsxs(z,{children:[e.jsxs(Y,{children:[e.jsx(Q,{children:"buy"===l?"My open buy orders":"My open sell orders"}),e.jsx(W,{children:"buy"===l?`Your open buy limit orders for the market ${a.symbol}/${r.symbol}`:`Your open sell limit orders for the market ${a.symbol}/${r.symbol}`})]}),e.jsx(se,{className:"space-y-2",children:o&&!c?e.jsx(Vs,{type:l,assetAData:a,assetBData:r,usrLimitOrders:o}):null})]})}function Rs(s){const{type:l,usrHistory:a,assetAData:r,assetBData:i}=s,n=t.useMemo((()=>a?a.filter((e=>"buy"===l?e.op[1].pays.asset_id===i.id&&e.op[1].receives.asset_id===r.id:e.op[1].pays.asset_id===r.id&&e.op[1].receives.asset_id===i.id)).map((e=>(Re(e.op[1].fill_price.quote.asset_id,e.op[1].fill_price.base.asset_id),Re(e.op[1].pays.asset_id,e.op[1].receives.asset_id),e))).map((e=>{const s=me(e.op[1].fill_price.base.amount,[r,i].find((s=>s.id===e.op[1].fill_price.base.asset_id))?.precision),l=me(e.op[1].fill_price.quote.amount,[r,i].find((s=>s.id===e.op[1].receives.asset_id))?.precision);return{price:(l/s).toFixed(i.precision),baseAmount:s,quoteAmount:l,date:e.block_time,operation:e.op[1]}})):[]),[a,r,i,l]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsx("div",{className:"col-span-1 pl-3",children:"Price"}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:"buy"===l?r.symbol:i.symbol}),e.jsx("div",{className:"col-span-1 pl-3 text-md",children:"buy"===l?i.symbol:r.symbol}),e.jsx("div",{className:"col-span-1 pl-3",children:"Date"})]}),e.jsx(Ye,{className:"h-72 w-full rounded-md border",children:e.jsx("div",{className:"grid grid-cols-4",children:n.map(((s,a)=>e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"grid grid-cols-4 text-sm",children:[e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:s.price}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?s.baseAmount:s.quoteAmount}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:"buy"===l?s.quoteAmount:s.baseAmount}),e.jsx("div",{className:"col-span-1 border-r-2 pl-3",children:$s(s.date)})]})},`mts_${a}_${l}`)))})})]})}function ys(s){const{type:l,usrHistory:a,marketHistoryInProgress:r,reset:i,assetAData:t,assetBData:n}=s;return e.jsxs(z,{children:[e.jsxs(Y,{children:[e.jsx(Q,{children:"buy"===l?"Your recently completed buy orders":"Your recently completed sell orders"}),e.jsx(W,{children:"buy"===l?"The table below lists your recently completed buy orders":"The table below lists your recently completed sell orders"})]}),e.jsxs(se,{className:"space-y-2",children:[a&&a.length||r?null:"buy"===l?e.jsx(e.Fragment,{children:"No recently completed purchases found"}):e.jsx(e.Fragment,{children:"No recently completed sales found"}),a&&a.length?e.jsx(Rs,{type:l,usrHistory:a,assetAData:t,assetBData:n}):null]})]})}function zs(s){const{activeLimitCard:l,assetAData:a,assetBData:r,usr:i,marketItr:n,setMarketItr:c,usrLimitOrders:d,usrHistory:o,publicMarketHistory:m,_resetMarketData:x}=s,[h,u]=t.useState(!1);t.useEffect((()=>{m&&u(!1)}),[m]);const[j,p]=t.useState("marketTrades"),[b,g]=t.useState("buy"),[y,f]=t.useState("buy"),[N,v]=t.useState("buy"),w={backgroundColor:"#252526",color:"white"};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 mt-5",children:e.jsxs(ge,{defaultValue:"marketTrades",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-3 gap-2",children:["marketTrades"===j?e.jsx(k,{value:"marketTrades",style:w,children:"Market trades"}):e.jsx(k,{value:"marketTrades",onClick:()=>p("marketTrades"),children:"Market trades"}),"usrLimitOrders"===j?e.jsx(k,{value:"usrLimitOrders",style:w,children:"Your open orders"}):e.jsx(k,{value:"usrLimitOrders",onClick:()=>p("usrLimitOrders"),children:"Your open orders"})]}),e.jsx(ee,{value:"marketTrades",children:e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===b?e.jsx(k,{value:"buy",style:w,children:"Buy orders"}):e.jsx(k,{value:"buy",onClick:()=>g("buy"),children:"Buy orders"}),"sell"===b?e.jsx(k,{value:"sell",style:w,children:"Sell orders"}):e.jsx(k,{value:"sell",onClick:()=>g("sell"),children:"Sell orders"})]}),e.jsx(ee,{value:"buy",children:e.jsx(fs,{type:"buy",publicMarketHistory:m,marketHistoryInProgress:h,reset:()=>{x(),u(!0),c(n+1)},assetAData:a,assetBData:r})}),e.jsx(ee,{value:"sell",children:e.jsx(fs,{type:"sell",publicMarketHistory:m,marketHistoryInProgress:h,reset:()=>{x(),u(!0),c(n+1)},assetAData:a,assetBData:r})})]})}),e.jsx(ee,{value:"usrHistory",children:e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===y?e.jsx(k,{value:"buy",style:w,children:"Buy orders"}):e.jsx(k,{value:"buy",onClick:()=>f("buy"),children:"Buy orders"}),"sell"===y?e.jsx(k,{value:"sell",style:w,children:"Sell orders"}):e.jsx(k,{value:"sell",onClick:()=>f("sell"),children:"Sell orders"})]}),e.jsx(ee,{value:"buy",children:e.jsx(ys,{type:"buy",assetAData:a,assetBData:r,usrHistory:o,marketHistoryInProgress:h,reset:()=>{x(),u(!0),c(n+1)}})}),e.jsx(ee,{value:"sell",children:e.jsx(ys,{type:"sell",assetAData:a,assetBData:r,usrHistory:o,marketHistoryInProgress:h,reset:()=>{x(),u(!0),c(n+1)}})})]})}),e.jsx(ee,{value:"usrLimitOrders",children:e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-2",children:["buy"===N?e.jsx(k,{value:"buy",style:w,children:"Your buy orders"}):e.jsx(k,{value:"buy",onClick:()=>v("buy"),children:"Your buy orders"}),"sell"===N?e.jsx(k,{value:"sell",style:w,children:"Your sell orders"}):e.jsx(k,{value:"sell",onClick:()=>v("sell"),children:"Your sell orders"})]}),e.jsx(ee,{value:"buy",children:e.jsx(gs,{type:"buy",assetAData:a,assetBData:r,usrLimitOrders:d,usrHistory:o,marketHistoryInProgress:h,reset:()=>{x(),u(!0),c(n+1)}})}),e.jsx(ee,{value:"sell",children:e.jsx(gs,{type:"sell",assetAData:a,assetBData:r,usrLimitOrders:d,usrHistory:o,marketHistoryInProgress:h,reset:()=>{x(),u(!0),c(n+1)}})})]})})]})})})}function Ys(s){const{usr:l,assetA:a,assetB:r,assetAData:i,assetADetails:n,assetABitassetData:c,assetBData:d,assetBDetails:o,assetBBitassetData:m,limitOrderFee:x,setAssetA:h,setAssetB:u}=s,j=t.useSyncExternalStore(Ie.subscribe,Ie.get,(()=>!0)),p=t.useSyncExternalStore(Ve.subscribe,Ve.get,(()=>!0)),b=t.useMemo((()=>l&&l.chain&&(j||p)?"bitshares"===l.chain?j:p:[]),[j,p,l]),[g,y]=t.useState(null),[f,N]=t.useState(null),[v,w]=t.useState([]),[S,$]=t.useState([]),[_,D]=t.useState(null),[F,B]=t.useState(null),[T,O]=t.useState(null),[P,C]=t.useState(null),[M,L]=t.useState(null),[E,V]=t.useState(0),[U,q]=t.useState(0),[I,R]=t.useState("buy"),[X,K]=t.useState("buy"),J=t.useMemo((()=>Re(i.id,d.id)),[i,d]);function G(){y(null),N(null)}t.useEffect((()=>{(async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()).type;let l=I;return("buy"===s||"sell"===s)&&(l=s),{finalType:l}})().then((({finalType:e})=>{e!==I&&R(e)}))}),[]);const Z=t.useMemo((()=>Us([l.chain,a,r,l.id])),[l,a,r,U]),{data:le,loading:ae,error:re}=ss(Z);t.useEffect((()=>{!le||ae||re?(y(null),N(null)):(y(le.bids),N(le.asks),w(le.bids),$(le.asks))}),[le,ae,re]);const ie=t.useMemo((()=>qs([l.chain,i.id,d.id,l.id])),[l,i,d,E]),{data:te,loading:ne,error:ce}=ss(ie);t.useEffect((()=>{!te||ne||ce?(D(null),B(null),O(null),C(null),L(null)):(D(te.balances),B(te.accountLimitOrders),O(te.marketHistory),C(te.usrTrades),L(te.ticker))}),[te,ne,ce]);const de={backgroundColor:"#252526",color:"white"},[oe,me]=t.useState(!1),xe=e.jsxs(Ee,{children:[e.jsx(Ue,{asChild:!0,style:{position:"relative"},children:e.jsxs(z,{className:"mt-5",children:[e.jsxs(Y,{className:"pt-4 pb-2",children:[e.jsx(Q,{children:"Market summary"}),e.jsxs(W,{className:"text-lg",children:["buy"===I?`${a}/${r}`:null,"sell"===I?`${r}/${a}`:null]})]}),e.jsx(se,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Latest price:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:M&&i?Pe(M.latest,i.precision):"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr change:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:M?M.percent_change:"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr base volume:"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(H,{variant:"outline",className:"ml-2 mb-1",children:[M?null:"?","buy"===I&&M?M.base_volume:null,"sell"===I&&M?M.quote_volume:null]})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr quote volume:"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(H,{variant:"outline",className:"ml-2 mb-1",children:[M?null:"?","buy"===I&&M?M.quote_volume:null,"sell"===I&&M?M.base_volume:null]})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Lowest ask:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:M&&i?Pe(M.lowest_ask,i.precision):"?"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Highest bid:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2",children:M&&i?Pe(M.highest_bid,i.precision):"?"})})]})]})})]})}),e.jsxs(qe,{className:"w-80 text-sm text-center",children:[e.jsxs("b",{children:[a,"/",r," External market links"]}),e.jsx("br",{}),e.jsx(Me,{variant:"outline",classnamecontents:"mb-2 mt-2",type:"button",text:"üîé Blocksights market explorer",hyperlink:"bitshares"===l.chain?`https://blocksights.info/#/markets/${"buy"===I?a:r}/${"buy"===I?r:a}`:`https://blocksights.info/#/markets/${"buy"===I?a:r}/${"buy"===I?r:a}?network=testnet`}),"bitshares"===l.chain?e.jsxs(e.Fragment,{children:[e.jsx(Me,{variant:"outline",classnamecontents:"ml-2",type:"button",text:"üîó BTS.Exchange",hyperlink:"buy"===I?`https://bts.exchange/#/market/${a}_${r}?r=nftprofessional1`:`https://bts.exchange/#/market/${r}_${a}?r=nftprofessional1`}),e.jsx(Me,{variant:"outline",classnamecontents:"ml-2",type:"button",text:"üîó BTWTY",hyperlink:"buy"===I?`https://wallet.btwty.com/market/${a}_${r}?r=nftprofessional1`:`https://wallet.btwty.com/market/${r}_${a}?r=nftprofessional1`}),e.jsx(Me,{variant:"outline",classnamecontents:"ml-2 mt-2",type:"button",text:"üîó XBTS",hyperlink:"buy"===I?`https://ex.xbts.io/market/${a}_${r}?r=nftprofessional1`:`https://ex.xbts.io/market/${r}_${a}?r=nftprofessional1`})]}):null]})]});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsxs(ge,{defaultValue:I,value:I,className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-2",children:[i&&d?null:e.jsxs(e.Fragment,{children:[e.jsx(k,{disabled:!0,value:"buy",style:de,children:"Buy"}),e.jsx(k,{disabled:!0,value:"sell",children:"Sell"})]}),i&&d&&"buy"===I?e.jsxs(e.Fragment,{children:[e.jsx(k,{value:"buy",style:de,children:"Buy"}),e.jsx(k,{value:"sell",onClick:()=>{R("sell"),window.history.replaceState({},"",`${window.location.pathname}?${new URLSearchParams({...new URLSearchParams(window.location.search),price:0}).toString()}`)},children:"Sell"})]}):null,i&&d&&"sell"===I?e.jsxs(e.Fragment,{children:[e.jsx(k,{value:"buy",onClick:()=>{R("buy"),window.history.replaceState({},"",`${window.location.pathname}?${new URLSearchParams({...new URLSearchParams(window.location.search),price:0,amount:0}).toString()}`)},children:"Buy"}),e.jsx(k,{value:"sell",style:de,children:"Sell"})]}):null]}),e.jsx(ee,{value:"buy",children:e.jsx(js,{usr:l,thisAssetA:a,thisAssetB:r,assetAData:i,assetBData:d,buyOrders:g,sellOrders:f,usrBalances:_,orderType:"buy",marketSearch:b,fee:x,invertedMarket:J},"buyLimit")}),e.jsx(ee,{value:"sell",children:e.jsx(js,{usr:l,thisAssetA:a,thisAssetB:r,assetAData:i,assetBData:d,buyOrders:g,sellOrders:f,usrBalances:_,orderType:"sell",marketSearch:b,fee:x,invertedMarket:J},"sellLimit")})]}),M&&i&&d?null:e.jsxs(z,{className:"mt-5",children:[e.jsxs(Y,{className:"pt-4 pb-2",children:[e.jsx(Q,{children:"Market summary"}),e.jsx(W,{className:"text-lg",children:"‚ùî/‚ùî"})]}),e.jsx(se,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Latest price:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr change:"}),e.jsx("div",{className:"col-span-3",children:"‚ùî"})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr base volume:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr quote volume:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Lowest ask:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Highest bid:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2",children:"‚ùî"})})]})]})})]}),M&&i&&d?xe:null]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs(z,{children:[e.jsx(Y,{className:"pt-2 pb-2",children:e.jsxs(Q,{className:"text-center text-lg",children:["bitshares"===l.chain?"Bitshares":"Bitshares (Testnet)"," DEX Market controls"]})}),e.jsx(se,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(us,{assetSymbol:a,assetData:i,storeCallback:h,otherAsset:r,marketSearch:b,type:"buy"===I?"quote":"base",size:"small"}),e.jsx("a",{style:{lineHeight:1},href:`/dex/index.html?market=${r}_${a}`,onClick:()=>me(!0),children:e.jsx(je,{variant:"outline",className:"w-full h-7",children:oe?e.jsx(Xe,{className:"animate-spin"}):e.jsx(Xe,{})})}),e.jsx(us,{assetSymbol:r,assetData:d,storeCallback:u,otherAsset:a,marketSearch:b,type:"sell"===I?"quote":"base",size:"small"})]})})]})}),e.jsx("div",{className:"flex-grow",style:{paddingBottom:"0px"},children:n?e.jsx(ns,{asset:a,assetData:i,assetDetails:n,bitassetData:c,marketSearch:b,chain:l.chain,usrBalances:_,type:"buy"===I?"buy":"sell"}):e.jsxs(z,{children:[e.jsxs(Y,{className:"pb-2 pt-4",children:[e.jsx(Q,{children:"buy"===I?"Quote asset":"Base asset"}),e.jsx(W,{className:"text-lg",children:"Loading..."})]}),e.jsx(se,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"}),e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"})]})})]})}),e.jsx("div",{className:"flex-grow",children:o?e.jsx(ns,{asset:r,assetData:d,assetDetails:o,bitassetData:m,marketSearch:b,chain:l.chain,usrBalances:_,type:"sell"===I?"buy":"sell"}):e.jsxs(z,{children:[e.jsxs(Y,{className:"pb-2 pt-4",children:[e.jsx(Q,{children:"sell"===I?"Base asset":"Quote asset"}),e.jsx(W,{className:"text-lg",children:"Loading..."})]}),e.jsx(se,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"}),e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"})]})})]})})]})})]}),a&&r&&i&&d?e.jsx(Es,{assetA:a,assetAData:i,assetB:r,assetBData:d,chain:l.chain}):null,e.jsx("div",{className:"grid grid-cols-1 gap-5 mt-5",children:i&&d?e.jsx(e.Fragment,{children:e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-1",children:["buy"===X?e.jsx(k,{value:"buy",style:de,children:"Buy orders (bids)"}):e.jsx(k,{value:"buy",onClick:()=>K("buy"),children:"Buy orders (bids)"}),"sell"===X?e.jsx(k,{value:"sell",style:de,children:"Sell orders (asks)"}):e.jsx(k,{value:"sell",onClick:()=>K("sell"),children:"Sell orders (asks)"})]}),e.jsx(ee,{value:"buy",children:e.jsx(bs,{cardType:"buy",activeLimitCard:I,assetA:a,assetAData:i,assetB:r,assetBData:d,buyOrders:g,previousBuyOrders:v,sellOrders:f,previousSellOrders:S,marketOrdersLoading:ae,orderBookItr:U,setOrderBookItr:q,_resetOrders:G,invertedMarket:J})}),e.jsx(ee,{value:"sell",children:e.jsx(bs,{cardType:"sell",activeLimitCard:I,assetA:a,assetAData:i,assetB:r,assetBData:d,buyOrders:g,previousBuyOrders:v,sellOrders:f,previousSellOrders:S,marketOrdersLoading:ae,orderBookItr:U,setOrderBookItr:q,_resetOrders:G,invertedMarket:J})})]})}):null}),a&&r?e.jsx(zs,{activeLimitCard:I,assetAData:i,assetBData:d,usr:l,marketItr:E,setMarketItr:V,usrLimitOrders:F,publicMarketHistory:T,usrHistory:P,_resetMarketData:function(){D(null),B(null),O(null),C(null),L(null)}}):null]})})}function Qs(s){const l={backgroundColor:"#252526",color:"white"};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto mt-5 mb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-2",children:[e.jsx(k,{disabled:!0,value:"buy",style:l,children:"Buy"}),e.jsx(k,{disabled:!0,value:"sell",children:"Sell"})]}),e.jsx(ee,{value:"buy",children:e.jsxs(z,{children:[e.jsxs(Y,{className:"pb-2",children:[e.jsx(Q,{children:"Market limit order form"}),e.jsx(W,{children:"Use this form to create a limit order operation."})]}),e.jsx(se,{children:e.jsxs("div",{className:"grid grid-cols-1",children:[e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:"Price"}),e.jsx("div",{className:"text-gray-500 text-right",children:e.jsx("span",{variant:"link",children:"?"})})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:"Your price per ? in ?"}),e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:"Amount"}),e.jsx("div",{className:"text-gray-500 text-right",children:"?"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:"The amount of ? you ......"}),e.jsxs("div",{className:"grid grid-cols-2 mt-2",children:[e.jsx("div",{className:"text-sm mt-1",children:"Total"}),e.jsx("div",{className:"text-gray-500 text-right",children:"?"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{disabled:!0,className:"mb-2"})}),e.jsx("div",{className:"col-span-1 text-sm",children:"The total ? you will ..."}),e.jsx("div",{className:"text-sm col-span-1 mt-2",children:"Limit order expriration"}),e.jsx("div",{className:"col-span-1",children:e.jsx(We,{disabled:!0,children:e.jsx(Je,{className:"mb-3",children:e.jsx(Ke,{placeholder:"1hr"})})})}),e.jsx("div",{className:"col-span-1 text-sm",children:"Time till expiration..."}),e.jsx("div",{className:"text-sm col-span-1",children:"Fee"}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{disabled:!0,label:"fees"})}),e.jsx("div",{className:"col-span-1 text-sm",children:"The network fee..."}),e.jsx("div",{className:"col-span-1",children:e.jsx(je,{disabled:!0,className:"mt-4 mb-1",variant:"outline",type:"submit",children:"Submit"})})]})})]})})]}),e.jsxs(z,{className:"mt-5",children:[e.jsxs(Y,{className:"pt-4 pb-2",children:[e.jsx(Q,{children:"Market summary"}),e.jsx(W,{className:"text-lg",children:"‚ùî/‚ùî"})]}),e.jsx(se,{className:"text-sm pb-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Latest price:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr change:"}),e.jsx("div",{className:"col-span-3",children:"‚ùî"})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr base volume:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"24Hr quote volume:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Lowest ask:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2 mb-1",children:"‚ùî"})})]}),e.jsxs("div",{className:"grid grid-cols-5",children:[e.jsx("div",{className:"col-span-2",children:"Highest bid:"}),e.jsx("div",{className:"col-span-3",children:e.jsx(H,{variant:"outline",className:"ml-2",children:"‚ùî"})})]})]})})]})]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"grid grid-cols-1 gap-y-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsxs(z,{children:[e.jsx(Y,{className:"pt-2 pb-2",children:e.jsx(Q,{className:"text-center text-lg",children:"DEX Market controls"})}),e.jsx(se,{className:"pb-3",children:e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsx(je,{variant:"outline",className:"h-5 p-3",children:"‚ùî"}),e.jsx(je,{variant:"outline",className:"w-full h-5 p-3",children:e.jsx(Xe,{})}),e.jsx(je,{variant:"outline",className:"h-5 p-3",children:"‚ùî"})]})})]})}),e.jsx("div",{className:"flex-grow",style:{paddingBottom:"0px"},children:e.jsxs(z,{children:[e.jsxs(Y,{className:"pb-2 pt-4",children:[e.jsx(Q,{children:"? asset"}),e.jsx(W,{className:"text-lg",children:"Loading..."})]}),e.jsx(se,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"}),e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"})]})})]})}),e.jsx("div",{className:"flex-grow",children:e.jsxs(z,{children:[e.jsxs(Y,{className:"pb-2 pt-4",children:[e.jsx(Q,{children:"? asset"}),e.jsx(W,{className:"text-lg",children:"Loading..."})]}),e.jsx(se,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"}),e.jsx(A,{className:"h-4 w-[250px]"}),e.jsx(A,{className:"h-4 w-[200px]"})]})})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 mt-5",children:[e.jsx(z,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Q,{children:"?"}),e.jsx(W,{children:"loading..."})]})}),e.jsx(z,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Q,{children:"?"}),e.jsx(W,{children:"loading..."})]})}),e.jsx(z,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Q,{children:"?"}),e.jsx(W,{children:"loading..."})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-5 mt-5",children:e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-1",children:[e.jsx(k,{value:"buy",style:l,children:"Buy"}),e.jsx(k,{value:"sell",children:"Sell"})]}),e.jsx(ee,{value:"buy",children:e.jsx(z,{children:e.jsxs(Y,{children:[e.jsx(Q,{children:"Loading market orders"}),e.jsx(W,{children:"Fetching requested market data, please wait..."}),e.jsxs(se,{children:[e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"})]}),e.jsx(As,{children:e.jsx(je,{className:"mt-5",children:"Retry request"})})]})})})]})}),e.jsx("div",{className:"grid grid-cols-1 mt-5",children:e.jsxs(ge,{defaultValue:"marketTrades",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-3 gap-2",children:[e.jsx(k,{value:"marketTrades",style:l,children:"Market trades"}),e.jsx(k,{value:"usrHistory",children:"Your trades"}),e.jsx(k,{value:"usrLimitOrders",children:"Your open orders"})]}),e.jsx(ee,{value:"marketTrades",children:e.jsxs(ge,{defaultValue:"buy",className:"w-full",children:[e.jsxs(ye,{className:"grid w-full grid-cols-2 gap-2",children:[e.jsx(k,{value:"buy",style:l,children:"Buy orders"}),e.jsx(k,{value:"sell",children:"Sell orders"})]}),e.jsx(ee,{value:"buy",children:e.jsxs(z,{children:[e.jsxs(Y,{children:[e.jsx(Q,{children:"Completed ‚ùî orders"}),e.jsx(W,{children:"Recently completed ‚ùî orders on the Bitshares DEX"})]}),e.jsxs(se,{className:"space-y-2",children:[e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"}),e.jsx(A,{className:"h-4 w-full mt-1"})]})]})})]})})]})})]})})}function jl(s){const l=t.useSyncExternalStore(ls.subscribe,ls.get,(()=>!0)),a=t.useSyncExternalStore(rs.subscribe,rs.get,(()=>!0)),r=t.useSyncExternalStore(as.subscribe,as.get,(()=>!0)),i=t.useSyncExternalStore(ts.subscribe,ts.get,(()=>!0)),n=t.useSyncExternalStore(is.subscribe,is.get,(()=>!0)),c=t.useSyncExternalStore(Ie.subscribe,Ie.get,(()=>!0)),d=t.useSyncExternalStore(Ve.subscribe,Ve.get,(()=>!0)),o=t.useMemo((()=>l&&l.chain?l.chain:"bitshares"),[l]);Bs(o??"bitshares",["assets","globalParams","marketSearch","pools"]);const m=t.useMemo((()=>o&&(a||r)?"bitshares"===o?a:r:[]),[a,r,o]),x=t.useMemo((()=>o&&(i||n)?"bitshares"===o?i:n:[]),[i,n,o]),h=t.useMemo((()=>o&&(c||d)?"bitshares"===o?c:d:[]),[c,d,o]),[u,j]=t.useState(0);t.useEffect((()=>{if(x&&x.parameters){const e=x.find((e=>1===e[0])),s=me(e[1].fee,5);j(s)}}),[x]);const p=t.useMemo((()=>h.map((e=>e.s))),[h]),b=t.useMemo((()=>h.map((e=>e.id))),[h]),[g,y]=t.useState(window.location.search?null:"BTS"),[f,N]=t.useState(window.location.search?null:"USD");t.useEffect((()=>{h&&h.length&&window.location.search&&async function(){const e=new URLSearchParams(window.location.search),s=Object.fromEntries(e.entries()).market;let l=g,a=f;if(s&&s.length){let e=s.split("_")[0].toUpperCase(),r=s.split("_")[1].toUpperCase();if(e&&r&&r.length&&e===r&&(r="BTS"===e?"USD":"1.3.0",console.log("Invalid market parameters - replaced quote asset.")),(!e||!e.length||!p.includes(e)&&!b.includes(e))&&(console.log("Asset A replaced with default."),l="1.3.0"),!l){const s=h.find((s=>s.id===e||s.s===e));s?l=s.s:(console.log("Setting default asset A"),l="1.3.0")}if((!r||!r.length||!p.includes(r)&&!b.includes(r))&&(console.log("Asset B replaced with default."),a="USD"!==l?"USD":"1.3.0"),!a){const s=h.find((e=>e.id===r||e.s===r));s?a=s.s:(console.log("Setting default asset B"),a="BTS"!==e&&"1.3.0"!==e?"1.3.0":"USD")}}else console.log("No market parameters found."),l="1.3.0",a="USD";return{finalAssetA:l,finalAssetB:a}}().then((({finalAssetA:e,finalAssetB:s})=>{y(e),N(s)}))}),[h]);const[v,k]=t.useState(null),[w,S]=t.useState(null),[$,_]=t.useState(null),[A,D]=t.useState(null),[F,B]=t.useState(null),[T,O]=t.useState(null);return t.useEffect((()=>{let e;if(g&&l&&l.chain){if(k(null),_(null),B(null),m&&m.length){const e=m.find((e=>e.s===g));if(e)return void k(e)}e=hs([l.chain,g]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&k(e)}))}return()=>{e&&e()}}),[g,l]),t.useEffect((()=>{let e;if(f&&l&&l.chain){if(S(null),D(null),O(null),m&&m.length){const e=m.find((e=>e.s===f));if(e)return void S(e)}e=hs([l.chain,f]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&S(e)}))}return()=>{e&&e()}}),[f,l]),t.useEffect((()=>{let e,s;return v&&l&&l.chain&&(e=xs([l.chain,v.id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&_(e)})),v.bitasset_data_id&&(s=ps([l.chain,v.bitasset_data_id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&B(e)})))),()=>{e&&e(),s&&s()}}),[v,l]),t.useEffect((()=>{let e,s;return w&&l&&l.chain&&(e=xs([l.chain,w.id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&D(e)})),w.bitasset_data_id&&(s=ps([l.chain,w.bitasset_data_id]).subscribe((({data:e})=>{e&&!e.error&&!e.loading&&O(e)})))),()=>{e&&e(),s&&s()}}),[w,l]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container mx-auto mt-5 mb-5",children:l&&l.chain&&g&&f&&v&&w&&$&&A?e.jsx(e.Fragment,{children:e.jsx(Ys,{usr:l,assetA:g,assetB:f,assetAData:v,assetADetails:$,assetABitassetData:F,assetBData:w,assetBDetails:A,assetBBitassetData:T,limitOrderFee:u,setAssetA:e=>{y(e)},setAssetB:e=>{N(e)}},`Market_${g}_${f}`)}):e.jsx(Qs,{})}),l&&l.username&&l.username.length?e.jsx(Ds,{usr:l}):null," "]})}export{jl as default};